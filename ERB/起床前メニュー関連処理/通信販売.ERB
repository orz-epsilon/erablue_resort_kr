@通信販売_BUY
#DIMS 右側表示モード
#DIM 現在ページ
#DIM 表示候補, キャラクタ数上限
#DIM 候補人数
#DIM 販売フラグ


DRAWLINE
PRINTL 통신 판매로 아이템을 구매합니다.
PRINTL ※개발 중이므로, 올바르게 작동하지 않을 수 있습니다.
DRAWLINE
;上
LOCALS = <div rect='81,31,1937,381' padding='50,25,50' border='31' bcolor='#C0C0C0'>
LOCALS += @"소지 루피：%NUM_FORMAT(MONEY)%<br>"
LOCALS += @"소지 ZP　：%ZP所持量全文字列()%"
LOCALS += "</div>"

;左側、アイテムの種類を羅列
LOCALS += "<div rect='81,444,1937,2812' padding='50,25,50' border='31' bcolor='#C0C0C0'>"
IF 右側表示モード == "アダルトグッズ"
	LOCALS += @"<nonbutton><font color='#%カラーパレット_HTML("黄")%'>[-1] 성인용품</font></nonbutton><br>"
ELSE
	LOCALS += "<button value='-1'>[-1] 성인용품</button><br>"
ENDIF
IF 右側表示モード == "消費アイテム"
	LOCALS += @"<nonbutton><font color='#%カラーパレット_HTML("黄")%'>[-2] 소비 아이템</font></nonbutton><br>"
ELSE
	LOCALS += "<button value='-2'>[-2] 소비 아이템</button><br>"
ENDIF
IF 施設改造度:20:0
	IF 右側表示モード == "自宅用アイテム"
		LOCALS += @"<nonbutton><font color='#%カラーパレット_HTML("黄")%'>[-3] 자택용 아이템</font></nonbutton><br>"
	ELSE
		LOCALS += "<button value='-3'>[-3] 자택용 아이템</button><br>"
	ENDIF
ENDIF
IF STRFIND(高速船記録:初回派遣先記録, @"叡智の殿堂_") >= 0
	IF 右側表示モード == "本・書籍アイテム"
		LOCALS += @"<nonbutton><font color='#%カラーパレット_HTML("黄")%'>[-4] 책・서적 아이템</font></nonbutton><br>"
	ELSE
		LOCALS += "<button value='-4'>[-4] 책・서적 아이템</button><br>"
	ENDIF
ENDIF
LOCALS += "<br>"
LOCALS += "<button value='-100'>[-100] 시스템 설명</button><br>"
LOCALS += "<br>"
LOCALS += "<button value='-99'>[-99] 돌아가기</button><br>"
LOCALS += "</div>"

;右側
LOCALS += "<div rect='2050,444,3875,2812' padding='50,25,50' border='31' bcolor='#C0C0C0'>"
CALL 通信販売_品揃え登録(LOCALS, 右側表示モード)
LOCALS += "</div>"

HTML_PRINT LOCALS
FOR LOCAL, 0, 30
	PRINTL
NEXT

$INPUT_LOOP
IF チュートリアルフラグ:通信販売 == 0
	RESULT = -100
ELSE
	BINPUT
ENDIF
LOCAL = RESULT
SELECTCASE LOCAL
	CASE -10 TO -1
		右側表示モード = %表示モード配列:(ABS(LOCAL) - 1)%
		販売フラグ = 0
		現在ページ = 0
		RESTART
	CASE -98
		INVERTBIT 購入済み非表示フラグ, 0
		RESTART
	CASE -99
		RETURN 0
	CASE -100
		CALL 通信販売チュートリアル()
		RESTART
ENDSELECT


; IF ITEMSTOCK(RESULT) == 1 || ITEMSTOCK(RESULT) == 4 || LOCAL < 0 || LOCAL > 2000
; 	RESTART
; ELSEIF ITEMSTOCK(RESULT) == 2
; 	PRINTW 売切です
; 	RESTART
; ELSEIF ITEMSTOCK(RESULT) == 3
; 	PRINTW 所持金が足りません
; 	RESTART
; ELSEIF ITEMSTOCK(RESULT) == 5
; 	PRINTW 既に十分持っています
; 	RESTART
; ENDIF
LOCAL = RESULT
DRAWLINE

IF LOCAL == 70
	現在ページ = 0
	PRINTL 【기운이 나는 약】을 구매하시겠습니까?
	PRINTL ※3일간, 사용한 캐릭터의 체력 최대치가 1000 증가합니다.
	PRINTBUTTON "[0] 예", 0
	PRINTL
	PRINTBUTTON "[1] 아니오", 1
	PRINTL
	BINPUT
	SIF RESULT
		RESTART
	PRINTL 누구에게 사용하시겠습니까?

	VARSET 表示候補
	候補人数 = 0
	FOR LOCAL, 1, CHARANUM
		SIF CFLAG:LOCAL:滞在期間 < 0
			CONTINUE
		表示候補:候補人数 = LOCAL
		候補人数 += 1
	NEXT

	$INPUT_LOOP_70
	VARSET LOCAL
	LOCALS = 
	;表示処理
	FOR LOCAL, 現在ページ * 30, 候補人数
		IF CFLAG:(表示候補:LOCAL):元気になる薬フラグ > 0
			LOCALS += @"<font color='#%カラーパレット_HTML("グレーアウト")%'><nonbutton>[{表示候補:LOCAL,3}] %ADD_STR_SPACE(NAME表示省略(NAME表示(表示候補:LOCAL)), "]", 1),41,LEFT%</nonbutton>"
			LOCALS += @"　사용 완료: 남은 {CFLAG:(表示候補:LOCAL):元気になる薬フラグ, 2}일　</font>"
		ELSE
			LOCALS += @"<button value = '{表示候補:LOCAL}'>[{表示候補:LOCAL,3}] %ADD_STR_SPACE(NAME表示省略(NAME表示(表示候補:LOCAL)), "]", 1),41,LEFT%</button>"
			IF CFLAG:(表示候補:LOCAL):滞在期間 == 1
				LOCALS += @"　　　　　<font color='#%カラーパレット_HTML("黄")%'>오늘 귀가</font>　"
			ELSEIF CFLAG:(表示候補:LOCAL):滞在期間 == 999
				LOCALS += "　　　　　상시 체류　"
			ELSEIF CFLAG:(表示候補:LOCAL):滞在期間 > 1
				LOCALS += @"　　　남은 체류: {CFLAG:(表示候補:LOCAL):滞在期間 - 1, 2}일　"
			ENDIF
		ENDIF
		LOCAL:1 += 1
		IF LOCAL:1 % 2 == 0
			HTML_PRINT LOCALS
			LOCALS = 
		ENDIF
		SIF LOCAL:1 > 29
			BREAK
	NEXT
	IF LOCALS != ""
		HTML_PRINT LOCALS
		LOCALS = 
	ENDIF
	PRINTL 
	IF 現在ページ > 0
		PRINTLC  [900]이전 페이지로
	ELSE
		PRINTLC  
	ENDIF
		PRINTLC  [999]돌아가기
	IF 現在ページ < 候補人数 / 30
		PRINTLC  [901]다음 페이지로
	ENDIF
	PRINTL
	DRAWLINE

	BINPUT
	LOCAL = RESULT
	SELECTCASE LOCAL
		CASE 999
			RESTART
		CASE 900
			現在ページ -= 1
			GOTO INPUT_LOOP_70
		CASE 901
			現在ページ += 1
			GOTO INPUT_LOOP_70
		CASEELSE
			IF MONEY < ITEMPRICE:70
				PRINTW 루피가 부족합니다.
				RESTART
			ENDIF
			MONEY -= ITEMPRICE:70
			PRINTFORMW %NAME表示(LOCAL)%의 체력 최대치가 1000 증가했습니다.
			CFLAG:LOCAL:元気になる薬フラグ = 3
			CALL 体力変動素質適用処理(LOCAL)
			BASE:LOCAL:体力 = MIN(MAXBASE:LOCAL:体力, BASE:LOCAL:体力 + 1000)
	ENDSELECT
	GOTO INPUT_LOOP_70
ENDIF

IF LOCAL == 90
	現在ページ = 0
	PRINTL 【기억 소거 & 재생약】을 구매하시겠습니까?
	PRINTL ※연모나 섹스 파트너 등 후천적인 소질의 일부, 관계, 개별적으로 설정된 것 이외의 고유 관계 등을 리셋하여 동정과 처녀를 다시 부여합니다
	PRINTL ※원래 상정된 사양이 아니므로 예상치 못한 버그가 발생할 수 있습니다! 세이브 데이터를 나누어 이용해 주세요!
	PRINTBUTTON "[0] 예", 0
	PRINTL
	PRINTBUTTON "[1] 아니오", 1
	PRINTL
	BINPUT
	SIF RESULT
		RESTART
	PRINTL 누구에게 사용하시겠습니까?

	VARSET 表示候補
	候補人数 = 0
	FOR LOCAL, 1, CHARANUM
		SIF CFLAG:LOCAL:滞在期間 < 0
			CONTINUE
		表示候補:候補人数 = LOCAL
		候補人数 += 1
	NEXT

	$INPUT_LOOP_90
	VARSET LOCAL
	LOCALS = 
	;表示処理
	FOR LOCAL, 現在ページ * 30, 候補人数
		LOCALS += @"<button value = '{表示候補:LOCAL}'>[{表示候補:LOCAL,3}] %ADD_STR_SPACE(NAME表示省略(NAME表示(表示候補:LOCAL)), "]", 1),41,LEFT%</button>"
		IF CFLAG:(表示候補:LOCAL):滞在期間 == 1
			LOCALS += @"　　　　　<font color='#%カラーパレット_HTML("黄")%'>오늘 귀가</font>　"
		ELSEIF CFLAG:(表示候補:LOCAL):滞在期間 == 999
			LOCALS += "　　　　　상시 체류　"
		ELSEIF CFLAG:(表示候補:LOCAL):滞在期間 > 1
			LOCALS += @"　　　남은 체류：{CFLAG:(表示候補:LOCAL):滞在期間 - 1, 2}일　"
		ENDIF
		LOCAL:1 += 1
		IF LOCAL:1 % 2 == 0
			HTML_PRINT LOCALS
			LOCALS = 
		ENDIF
		SIF LOCAL:1 > 29
			BREAK
	NEXT

	IF LOCALS != ""
	HTML_PRINT LOCALS
	LOCALS = 
	ENDIF
	PRINTL 
	IF 現在ページ > 0
		PRINTLC  [900]이전 페이지로
	ELSE
		PRINTLC  
	ENDIF
		PRINTLC  [999]돌아가기
	IF 現在ページ < 候補人数 / 30
		PRINTLC  [901]다음 페이지로
	ENDIF
	PRINTL
	DRAWLINE

	BINPUT
	LOCAL = RESULT
	SELECTCASE LOCAL
		CASE 999
			RESTART
		CASE 900
			現在ページ -= 1
			GOTO INPUT_LOOP_90
		CASE 901
			現在ページ += 1
			GOTO INPUT_LOOP_90
		CASEELSE
			IF MONEY < ITEMPRICE:90
				PRINTW 루피가 부족합니다.
				RESTART
			ENDIF
			MONEY -= ITEMPRICE:90
			CALL 記憶消去処理(LOCAL)
	ENDSELECT
	GOTO INPUT_LOOP_90
ENDIF

IF LOCAL == 41
	MONEY -= ITEMPRICE:LOCAL
	ITEM:LOCAL ++
	PRINTW 최음제를 정제했습니다
	RESTART
ENDIF
;複数所持アイテム
SELECTCASE ITEM種別(LOCAL)
	CASE "消費アイテム"
		PRINTFORM %ITEMNAME:LOCAL%을(를) 몇 개 구입하시겠습니까?
		PRINTFORML 
		;金欠、アイテム数の超過はあとで合わせる
		PRINTL [0] - 그만두다
		PRINT [1] - 1　
		PRINT [5] - 5　
		PRINT [10] - 10　
		PRINT [20] - 20　
		PRINT [50] - 50　
		PRINT [99] - 살 수 있는 만큼
		BINPUT
		SIF RESULT * ITEMPRICE:LOCAL > MONEY
			RESULT = MONEY / ITEMPRICE:LOCAL
		ITEM:LOCAL += RESULT
		IF ITEM:LOCAL > 99
			RESULT = 99 - (ITEM:LOCAL - RESULT)
			ITEM:LOCAL = 99
		ENDIF
		PRINTFORMW %ITEMNAME:LOCAL%을(를) {RESULT}개, %NUM_FORMAT(RESULT * ITEMPRICE:LOCAL)%%MONEYLABEL%으로 구매했습니다
		MONEY -= RESULT * ITEMPRICE:LOCAL
		RESTART
	CASE "アダルトグッズ"
		SIF ITEM:LOCAL
			RESTART
		PRINTFORML %ITEMNAME:LOCAL%을(를) 구매하시겠습니까?
		PRINTL [0] - 예  [1] - 아니요
		INPUT
		SIF RESULT
			RESTART
		IF MONEY < ITEMPRICE:LOCAL
			PRINTW 루피가 부족합니다.
			RESTART
		ENDIF
		ITEM:LOCAL ++
		MONEY -= ITEMPRICE:LOCAL
		RESTART
	CASE "自宅用アイテム", "本・書籍アイテム"
		SIF ITEM:LOCAL
			RESTART
		CALL 通信販売_アイテム説明(ITEMNAME:LOCAL)
		PRINTFORML %ITEMNAME:LOCAL%을(를) 구매하시겠습니까?
		PRINTL [0] - 예  [1] - 아니요
		INPUT
		SIF RESULT
			RESTART
		IF MONEY < ITEMPRICE:LOCAL
			PRINTW 루피가 부족합니다.
			RESTART
		ENDIF
		ITEM:LOCAL ++
		MONEY -= ITEMPRICE:LOCAL
		RESTART
ENDSELECT


@通信販売_品揃え登録(HTML文字列, 右側表示モード)
#DIMS REF HTML文字列
#DIMS 右側表示モード

SELECTCASE 右側表示モード
	CASE "アダルトグッズ"
		HTML文字列 += "・성적인 커맨드의 사용 조건으로 필요한 성인용품 카테고리입니다.<br><br>"
		FOR LOCAL, 0, 200
			SIF ITEMNAME:LOCAL == ""
				CONTINUE
			SIF ITEM種別(LOCAL) != "アダルトグッズ"
				CONTINUE
			SIF ITEM:LOCAL && 購入済み非表示フラグ
				CONTINUE
			IF ITEM:LOCAL
				HTML文字列 += @"<nonbutton><font color='#%カラーパレット_HTML("グレーアウト")%'>[{LOCAL, 2}] %ITEMNAME:LOCAL, 20, LEFT% (구매 완료)　　가격:%NUM_FORMAT(ITEMPRICE:LOCAL), 6%루피</font></nonbutton>"
			ELSE
				HTML文字列 += @"<button value='{LOCAL}'>[{LOCAL, 2}] %ITEMNAME:LOCAL, 20, LEFT% 을(를) 구매하기</button>　　　가격:%NUM_FORMAT(ITEMPRICE:LOCAL), 6%루피"
			ENDIF
			HTML文字列 += "<br>"
		NEXT
		HTML文字列 += "</div>"
		IF 購入済み非表示フラグ
			HTML文字列 += @"<div rect='2250,3044,3875,2812'><button value='-98'>[-98] 구매한 아이템을 표시 <font color='#%カラーパレット_HTML("グレーアウト")%'>한다</font> / 하지 않는다</button>"
		ELSE
			HTML文字列 += @"<div rect='2250,3044,3875,2812'><button value='-98'>[-98] 구매한 아이템을 표시 한다 / <font color='#%カラーパレット_HTML("グレーアウト")%'>하지 않는다</font></button>"
		ENDIF
	CASE "消費アイテム"
		HTML文字列 += "・한 번 사용하면 사라지거나, 사용 시 대상을 선택해야 하는 아이템 카테고리입니다。<br><br>"
		FOR LOCAL, 0, 200
			SIF ITEMNAME:LOCAL == ""
				CONTINUE
			SIF ITEM種別(LOCAL) != "消費アイテム"
				CONTINUE
			HTML文字列 += @"<button value='{LOCAL}'>[{LOCAL, 2}] %ITEMNAME:LOCAL, 20, LEFT% 을(를) 구매한다</button>　　가격:%NUM_FORMAT(ITEMPRICE:LOCAL), 7%루피　　소지 수:{ITEM:LOCAL, 2}개"
			HTML文字列 += "<br>"
		NEXT
	CASE "自宅用アイテム"
		HTML文字列 += "・자택에서의 커맨드 사용 조건으로 필요한 아이템 카테고리입니다。<br><br>"
		FOR LOCAL, 0, 200
			SIF ITEMNAME:LOCAL == ""
				CONTINUE
			SIF ITEM種別(LOCAL) != "自宅用アイテム"
				CONTINUE
			SIF ITEM:LOCAL && 購入済み非表示フラグ
				CONTINUE
			IF ITEM:LOCAL
				HTML文字列 += @"<nonbutton><font color='#%カラーパレット_HTML("グレーアウト")%'>[{LOCAL, 2}] %ITEMNAME:LOCAL, 20, LEFT% (구매 완료)　　가격:%NUM_FORMAT(ITEMPRICE:LOCAL), 6%루피</font></nonbutton>"
			ELSE
				HTML文字列 += @"<button value='{LOCAL}'>[{LOCAL, 2}] %ITEMNAME:LOCAL, 20, LEFT% 을(를) 구매한다</button>　　　가격:%NUM_FORMAT(ITEMPRICE:LOCAL), 6%루피"
			ENDIF
			HTML文字列 += "<br>"
		NEXT
		HTML文字列 += "</div>"
		IF 購入済み非表示フラグ
			HTML文字列 += @"<div rect='2250,3044,3875,2812'><button value='-98'>[-98] 구매한 아이템을 표시 <font color='#%カラーパレット_HTML("グレーアウト")%'>한다</font> / 하지 않는다</button>"
		ELSE
			HTML文字列 += @"<div rect='2250,3044,3875,2812'><button value='-98'>[-98] 구매한 아이템을 표시 한다 / <font color='#%カラーパレット_HTML("グレーアウト")%'>하지 않는다</font></button>"
		ENDIF
	CASE "本・書籍アイテム"
		HTML文字列 += "・특수 능력 획득 조건이 되는 아이템 카테고리입니다。<br><br>"
		FOR LOCAL, 0, 200
			SIF ITEMNAME:LOCAL == ""
				CONTINUE
			SIF ITEM種別(LOCAL) != "本・書籍アイテム"
				CONTINUE
			SIF ITEM:LOCAL && 購入済み非表示フラグ
				CONTINUE
			IF ITEM:LOCAL
				HTML文字列 += @"<nonbutton><font color='#%カラーパレット_HTML("グレーアウト")%'>[{LOCAL, 2}] %ITEMNAME:LOCAL, 20, LEFT% (구매 완료)　　가격:%NUM_FORMAT(ITEMPRICE:LOCAL), 6%루피</font></nonbutton>"
			ELSE
				HTML文字列 += @"<button value='{LOCAL}'>[{LOCAL, 2}] %ITEMNAME:LOCAL, 20, LEFT% 을(를) 구매한다</button>　　　가격:%NUM_FORMAT(ITEMPRICE:LOCAL), 6%루피"
			ENDIF
			HTML文字列 += "<br>"
		NEXT
		HTML文字列 += "</div>"
		IF 購入済み非表示フラグ
			HTML文字列 += @"<div rect='2250,3044,3875,2812'><button value='-98'>[-98] 구매한 아이템을 표시 <font color='#%カラーパレット_HTML("グレーアウト")%'>한다</font> / 하지 않는다</button>"
		ELSE
			HTML文字列 += @"<div rect='2250,3044,3875,2812'><button value='-98'>[-98] 구매한 아이템을 표시 한다 / <font color='#%カラーパレット_HTML("グレーアウト")%'>하지 않는다</font></button>"
		ENDIF
ENDSELECT


@ITEM種別(アイテム番号)
#FUNCTIONS
#DIM アイテム番号

SELECTCASE アイテム番号
	CASE 0 TO 20
		RETURNF "アダルトグッズ"
	CASE 40, 70, 73, 90, 91, 92
		RETURNF "消費アイテム"
	CASE 80 TO 83
		RETURNF "自宅用アイテム"
	CASE 60, 71, 72
		RETURNF "本・書籍アイテム"
ENDSELECT


@通信販売_アイテム説明(アイテム名)
#DIMS アイテム名

SELECTCASE アイテム名
	CASE "トランプセット"
		PRINTL 일반적인 트럼프 세트。
		PRINTL 이것 1세트로 여러 가지 놀이 방법을 즐길 수 있다.
		PRINTL ※자택 거실에서 「카드로 놀기」 커맨드를 해방
		PRINTL
	CASE "ドリンクセラー"
		PRINTL 음료를 많이 차갑게 하기 위한 마도구.
		PRINTL 이것만 있으면 많은 인원과의 집들이도 문제없다.
		PRINTL ※자택 거실에서 「술자리를 시작한다」 커맨드를 해방
		PRINTL
	CASE "マッサージマット"
		PRINTL 자택용 마사지 매트.
		PRINTL 역시 전용 도구는 사용감이 다르다.
		PRINTFORML ※자택 %CALLNAME:MASTER%의 방에서 「마사지를 시작한다」 커맨드를 해방
		PRINTL
	CASE "おこた"
		PRINTL 추운 겨울에 든든한 코타츠.
		PRINTL 여러 명이 들어가도 넓은 대형 타입.
		PRINTFORML ※겨울의 달, 호감도가 일정 이상인 캐릭터가 일본식 방에 놀러 온다 (최대 10명 정도)
		PRINTL
	CASE "書籍『引っ越しで幸せになる方法』"
		PRINTL 이사가 얼마나 인생을 풍요롭게 하고 행복으로 이어지는지를 쓴 책.
		PRINTL 저자는 지금까지 99번이나 이사를 했고, 다른 섬으로 이주하는 것도 드물지 않다고 한다.
		PRINTFORML ※ZP 상점에서 「임의 이사술」의 특수 능력을 해방
		PRINTL
	CASE "書籍『肉料理入門』"
		PRINTL 집에서 만들 수 있는 간단한 고기 요리 레시피가 실린 책.
		PRINTL 기본적인 굽는 법이나 밑준비 순서 등을 습득할 수 있다.
		PRINTL ※요리 메뉴 개발에서 다음 레시피를 등록
		PRINTL 　돈가스 샌드위치・1파운드 스테이크・불고기 세트
		PRINTL
	CASE "書籍『美味しい海鮮のススメ』"
		PRINTL 집에서 만들 수 있는 간편한 해산물 요리 레시피가 실린 책.
		PRINTL 기본적인 처리나 생선을 손질할 때의 작은 요령 등을 습득할 수 있다.
		PRINTL ※요리 메뉴 개발에서 다음 레시피를 등록
		PRINTL 　해산물 야키소바・회 다시마 조림・초밥 모듬
		PRINTL
ENDSELECT


