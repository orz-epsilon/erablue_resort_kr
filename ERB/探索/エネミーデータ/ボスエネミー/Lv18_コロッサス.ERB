
@敵BATTLE_STATE_Lv18_コロッサス(対象エネミー)
#DIM 対象エネミー
敵BATTLE_STATE:対象エネミー:Lv = 18
敵BATTLE_STATE:対象エネミー:最大ＨＰ = 24500
敵BATTLE_STATE:対象エネミー:ＨＰ = 24500
敵BATTLE_STATE:対象エネミー:攻撃力 = 890
敵BATTLE_STATE:対象エネミー:防御力 = 720
敵BATTLE_STATE:対象エネミー:回復力 = 0
敵BATTLE_STATE:対象エネミー:行動速度 = 200
敵BATTLE_STATE:対象エネミー:DA率 = 0
敵BATTLE_STATE:対象エネミー:TA率 = 0
敵BATTLE_STATE:対象エネミー:命中率 = 110
敵BATTLE_STATE:対象エネミー:回避率 = 5
敵BATTLE_STATE:対象エネミー:属性 = 0
敵BATTLE_STATE:対象エネミー:所持EXP = 2050
敵BATTLE_STATE:対象エネミー:所持ルピ = 2200
敵BATTLE_STATE:対象エネミー:最大チャージターン = 2

敵BATTLE_STATE:対象エネミー:ボスフラグ = 1
敵BATTLE_STATE:対象エネミー:ランダム不許可フラグ = 1

敵BATTLE_STATE_STR:対象エネミー:種族 = 機械_星晶獣

@敵討伐後処理_Lv18_コロッサス(隊列番号)
#DIM 隊列番号
#DIM ドロップ確率
#DIMS ドロップアイテム
#DIM データベース行数
#DIM トレハンLv

トレハンLv = 0
データベース行数 = デバフ番号取得("ドロップ率UP")
SIF データベース行数 > -1
	トレハンLv = DT_CELL_GET("戦闘効果データベース", データベース行数, "効果量_固定値")

ドロップ確率 = 30 + トレハンLv * 2
ドロップアイテム = 白銀の古紋
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 50 + トレハンLv * 2
ドロップアイテム = 古びた歯車
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 5 + トレハンLv * 2
ドロップアイテム = プロミネンスリアクター
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

@敵トリガー行動_Lv18_コロッサス

IF バフ番号取得_枠("大技待機", 戦闘行動キャラ) > -1
	;大技待機の次のターンに次元断
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%의 검이 맹렬한 기세로 내리쳐진다!
	アビ汎用文字列:実行時メッセージ２ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%의 차원단!
	アビテンプレート用_アビ名 = 次元断

	CALL アビ対象選択テンプレート_味方ランダムＸ体(1)
	アビ汎用変数:効果割合 = 1000
	CALL アビテンプレート_ダメージ処理_自属性
	敵BATTLE_STATE:(戦闘行動キャラ - 10):チャージターン = 0
	
	行動種別フラグ:戦闘行動キャラ:大技発動 = 1
	CALL 大技待機解除(戦闘行動キャラ)
	RETURN 1
ELSEIF 敵BATTLE_STATE:(戦闘行動キャラ - 10):ＨＰ < 敵BATTLE_STATE:(戦闘行動キャラ - 10):最大ＨＰ / 3 && GETBIT(敵BATTLE_STATE:(戦闘行動キャラ - 10):トリガー行動フラグ, 0) == 0
	;HPが1/3以下になったら大技待機
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%이 거대한 검을 겨누었다!!
	アビテンプレート用_アビ名 = 大技待機

	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:特殊表示オプション = 1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = 대기술 대기
	アビ汎用文字列:バフ・デバフ対象能力 = 대기술 대기
	アビ汎用変数:持続ターン = -1
	CALL アビテンプレート_有利効果_バフ効果セット

	;HPトリガー使い終わったのでフラグを立てる
	SETBIT 敵BATTLE_STATE:(戦闘行動キャラ - 10):トリガー行動フラグ, 0
	RETURN 1
ELSEIF 敵BATTLE_STATE:(戦闘行動キャラ - 10):ＨＰ < 敵BATTLE_STATE:(戦闘行動キャラ - 10):最大ＨＰ / 5 && GETBIT(敵BATTLE_STATE:(戦闘行動キャラ - 10):トリガー行動フラグ, 1) == 0
	;HPが1/5以下になったら大技待機
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%이 거대한 검을 겨누었다!!
	アビテンプレート用_アビ名 = 大技待機

	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:特殊表示オプション = 1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = 대기술 대기
	アビ汎用文字列:バフ・デバフ対象能力 = 대기술 대기
	アビ汎用変数:持続ターン = -1
	CALL アビテンプレート_有利効果_バフ効果セット

	;HPトリガー使い終わったのでフラグを立てる
	SETBIT 敵BATTLE_STATE:(戦闘行動キャラ - 10):トリガー行動フラグ, 1
	RETURN 1
ENDIF

@敵チャージ行動_Lv18_コロッサス
IF 敵BATTLE_STATE:(戦闘行動キャラ - 10):ＨＰ < 敵BATTLE_STATE:(戦闘行動キャラ - 10):最大ＨＰ / 5
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%이 거대한 검을 겨누었다!!
	アビテンプレート用_アビ名 = 大技待機

	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:特殊表示オプション = 1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用文字列:バフ・デバフ枠 = 대기술 대기
	アビ汎用文字列:バフ・デバフ対象能力 = 대기술 대기
	アビ汎用変数:持続ターン = -1
	CALL アビテンプレート_有利効果_バフ効果セット

ELSEIF 敵BATTLE_STATE:(戦闘行動キャラ - 10):最大チャージターン == 2
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%의 내부에서 업화가 뿜어져 나온다!!
	アビ汎用文字列:実行時メッセージ２ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%의 프로미넌스 리액터!
	アビテンプレート用_アビ名 = プロミネンスリアクター

	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用変数:効果割合 = 150
	CALL アビテンプレート_ダメージ処理_自属性

	CALL アビ汎用変数文字列リセット
	アビ汎用変数:効果割合 = 20
	アビ汎用文字列:バフ・デバフ枠 = 防御力A
	アビ汎用文字列:バフ・デバフ対象能力 = 방어력
	アビ汎用変数:持続ターン = 3
	アビ汎用変数:基礎成功確率 = 80
	CALL アビテンプレート_不利効果_デバフ効果セット

	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:効果割合 = 30
	アビ汎用文字列:バフ・デバフ枠 = 공격력A
	アビ汎用文字列:バフ・デバフ対象能力 = 공격력
	アビ汎用変数:持続ターン = 3
	CALL アビテンプレート_有利効果_バフ効果セット
	敵BATTLE_STATE:(戦闘行動キャラ - 10):最大チャージターン = 3

ELSE
	アビ汎用文字列:実行時メッセージ１ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%이 열기를 뿜어내며 방어 모드로 이행한다……!
	アビ汎用文字列:実行時メッセージ２ = %敵BATTLE_STATE_STR:(戦闘行動キャラ - 10):エネミー名%의 셸터!
	アビテンプレート用_アビ名 = シェルター

	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用変数:効果割合 = 80
	CALL アビテンプレート_ダメージ処理_自属性

	CALL アビ対象選択テンプレート_自己のみ
	CALL アビ汎用変数文字列リセット
	アビ汎用変数:効果割合 = 100
	アビ汎用文字列:バフ・デバフ枠 = 방어력A
	アビ汎用文字列:バフ・デバフ対象能力 = 방어력
	アビ汎用変数:持続ターン = 3
	CALL アビテンプレート_有利効果_バフ効果セット

	CALL アビ汎用変数文字列リセット
	アビ汎用変数:効果量 = 1000
	アビ汎用文字列:バフ・デバフ枠 = 재생A
	アビ汎用文字列:バフ・デバフ対象能力 = 재생
	アビ汎用変数:持続ターン = 3
	CALL アビテンプレート_有利効果_バフ効果セット

	敵BATTLE_STATE:(戦闘行動キャラ - 10):最大チャージターン = 2
ENDIF


@固有戦闘開始時処理_エネミー_Lv18_コロッサス()
;戦闘開始時にフィールドを張る
;永続効果なのでターン数は設定しない

IF ダンジョン名 == "バルツ地下廃工場"
	アビ汎用文字列:実行時メッセージ１ = 폐공장 가장 안쪽에는 몸을 태울 듯한 열기가 가득 차 있다……!
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:持続ターン = -1
	アビ汎用文字列:フィールド枠 = 몸을 태울 듯한 열기
	CALL アビテンプレート_フィールド効果セット
ENDIF


@フィールド説明文_身を焦がす熱気

LOCALS = 바르츠 지하 폐공장 가장 안쪽에서 전투 시작 시 발생하는 필드. <br>
LOCALS += "턴 종료 시, 물 속성이 아닌 아군 캐릭터 전원에게 100 데미지를 준다. <br>"
LOCALS += "효과 시간: 영구<br>"

詳細文文字列受け渡し変数 = %LOCALS%

@固有ターン終了時処理_フィールド_身を焦がす熱気
#DIM 味方番号
#DIM 効果量
;水属性以外の味方にスリップダメージ
効果量 = 100

FOR 味方番号, 0, 4
	SIF BATTLE_STATE:味方番号:キャラ登録番号 < 1
		CONTINUE
	;生者のみ
	SIF BATTLE_STATE:味方番号:ＨＰ < 1
		CONTINUE
	;水属性除外
	SIF BATTLE_STATE:味方番号:属性 == 1
		CONTINUE

	WSTR:(K++) = %CALLNAME:(BATTLE_STATE:味方番号:キャラ登録番号)%은(는) 몸을 태울 듯한 열기의 효과로 {効果量}의 데미지!
	BATTLE_STATE:味方番号:ＨＰ = MAX(BATTLE_STATE:味方番号:ＨＰ - 効果量, 0)
	IF BATTLE_STATE:味方番号:ＨＰ < 1
		WSTR:(K++) = %CALLNAME:(BATTLE_STATE:味方番号:キャラ登録番号)%은(는) 쓰러졌다!
		CALL 戦闘不能者登録(味方番号, -1)
	ENDIF
NEXT

CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
