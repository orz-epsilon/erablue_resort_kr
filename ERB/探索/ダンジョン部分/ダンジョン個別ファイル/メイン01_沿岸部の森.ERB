

@ダンジョン初期処理_沿岸部の森
;ダンジョン構造の読み込み
;0でない時、そのマスは存在する
#DIM 深度
#DIM 分岐

ダンジョンサブタイトル = FOREST OF COAST
ダンジョンマス画像URL_伏せ状態 = 壁_森
ダンジョン現在位置:0 = 0
ダンジョン現在位置:1 = 0
ダンジョン背景画像 = 背景_森

;スタート地点は必ず存在
;初期からオープン済みなので3を入れる
;ビット0：存在するか　ビット1：移動できるか　ビット2：そこから通路を伸ばすか　ビット3：入れないが表示する場合に使用
;ビット4以降：自由枠フラグ

IF GETVAR(@"ダンジョン構造配列_%ダンジョン名%:0:0") == 0
	SETVAR @"ダンジョン構造配列_%ダンジョン名%:0:0", 3
ENDIF

FOR 深度, 1, 100
	LOCAL = 0
	FOR 分岐, 0, 9
		IF ダンジョン構造配列_沿岸部の森:深度:分岐
			;既にマス情報が入ってるなら飛ばす
			LOCAL = 1
			CONTINUE
		ELSEIF ENUMFUNCBEGINSWITH(@"ダンジョンマス情報_沿岸部の森_{深度}_{分岐}")
			LOCAL = 1
			ダンジョン構造配列_沿岸部の森:深度:分岐 = 1
		ENDIF
	NEXT
	IF LOCAL
		ダンジョン最大深度 = 深度
	ENDIF
NEXT

@ダンジョン解説文_沿岸部の森

詳細文文字列受け渡し変数 = 
詳細文文字列受け渡し変数 += "리조트 섬 연안부에 펼쳐진 소규모 숲. <br>"
詳細文文字列受け渡し変数 += "강한 마물은 서식하지 않으며, 평화로운 풍경이 펼쳐져 있다. <br>"
詳細文文字列受け渡し変数 += "야채나 목재, 잡곡 등 흔한 소재를 입수할 수 있을 것이다. <br>"

;推奨レベルを返す
RETURN 1

@敵討伐後処理_ダンジョン固有_沿岸部の森(討伐エネミー数)
;ダンジョン内で戦闘した後に呼ばれる関数、主にダンジョンごとのドロップアイテム取得に使用
;まだ敵データはリセットしていないので敵BATTLE_STATEで色々情報は取得可能
#DIM 討伐エネミー数
#DIM ドロップ確率
#DIMS ドロップアイテム

ドロップ確率 = 10 * 討伐エネミー数
ドロップアイテム = 普通の木材
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 10 * 討伐エネミー数
ドロップアイテム = 普通の野菜
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 10 * 討伐エネミー数
ドロップアイテム = 雑穀
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 5 * 討伐エネミー数
ドロップアイテム = 星晶の破片
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 1 * 討伐エネミー数
ドロップアイテム = 赤銅の古紋
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)



@ダンジョンマス情報_沿岸部の森_0_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 0
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "1_0")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = %CALLNAME:PLAYER%은(는) 처음으로 던전에 발을 들였다.
			KSTR:(K++) = %CALLNAME:PLAYER%은(는) 성정수 era가 말했던 주의점을 떠올린다……
			CALL メッセージ欄表示用関数()
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			CALL 口上変数初期化
			WSTR:(K++) = 「잘 들어라. 왼쪽 위에 _IMAGE_自機アイコン_이 보이지?」
			WSTR:(K++) = 「그것이 너의 현재 위치다」
			KSTR:(K++) = 「다른 칸을 클릭하여 이동할 수 있다. 시험 삼아 옆 칸으로 이동해 보거라」
			CALL メッセージ欄表示用関数("顔エラ","星晶獣era",,0)
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_1_0(ARGS)
#DIMS マス番号
マス番号 = 1_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "2_0")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			LOCAL:1 = 0
			FOR LOCAL, 0, 4
				SIF BATTLE_STATE:LOCAL:キャラ登録番号 > 0
					LOCAL:1 ++
			NEXT
			IF LOCAL:1 < 2
				敵BATTLE_STATE_STR:1:エネミー名 = Lv2_ゴブリン
			ELSE
				敵BATTLE_STATE_STR:0:エネミー名 = Lv2_ゴブリン
				敵BATTLE_STATE_STR:1:エネミー名 = Lv2_ゴブリン
			ENDIF
			CALL 雑魚敵繰り返し戦闘処理
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 「방문한 적 없는 칸은, 그곳에 무엇이 있는지 처음에는 알 수 없다」
			WSTR:(K++) = 「적이 있는지, 보물 상자가 있는지……」
			KSTR:(K++) = 「봐라, 말하자마자 적이 나타났군」
			CALL メッセージ欄表示用関数("顔エラ","星晶獣era")
			
			LOCAL:1 = 0
			FOR LOCAL, 0, 4
				SIF BATTLE_STATE:LOCAL:キャラ登録番号 > 0
					LOCAL:1 ++
			NEXT
			IF LOCAL:1 < 2
				敵BATTLE_STATE_STR:1:エネミー名 = Lv2_ゴブリン
			ELSE
				敵BATTLE_STATE_STR:0:エネミー名 = Lv2_ゴブリン
				敵BATTLE_STATE_STR:1:エネミー名 = Lv2_ゴブリン
			ENDIF
			CALL 雑魚敵遭遇汎用処理

			CALL 口上変数初期化
			WSTR:(K++) = 「잡몹이 있는 칸은, 다시 방문함으로써 적을 찾을 수 있다」
			WSTR:(K++) = 「동료의 숙련도를 높이고, 루피를 모으기에는 최적이다」
			KSTR:(K++) = 「쓰러뜨릴 수 있다면, 말이지」
			CALL メッセージ欄表示用関数("顔エラ","星晶獣era")
			SETBIT ダンジョン構造配列_沿岸部の森:2:0, 1
			CALL 口上変数初期化
		ENDIF
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_沿岸部の森_2_0(ARGS)
#DIMS マス番号
マス番号 = 2_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		IF GETBIT(ダンジョン構造配列_沿岸部の森:3:0, 1)
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
		ELSE
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱
		ENDIF
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "3_0")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			KSTR:(K++) = 상자는 텅 비어있다.
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 「이번에는 보물상자네. 안에는 뭔가 아이템이 들어있을 거야」
			WSTR:(K++) = 「더 어려운 던전이라면, 함정이 설치되어 있을 수도 있어」
			KSTR:(K++) = 「이 던전에서는 무관한 일이지만. 사양 말고 열어보게」
			CALL メッセージ欄表示用関数("顔エラ","星晶獣era")
			CALL 口上変数初期化
			SETBIT ダンジョン構造配列_沿岸部の森:3:0, 1
			WSTR:(K++) = %CALLNAME:PLAYER%은(는) 보물상자를 열었다.
			KSTR:(K++) = 안에는 약초가 １０개 들어있었다!!
			CALL メッセージ欄表示用関数()

			CALL 口上変数初期化
			CALL アイテム増減汎用処理("薬草", 10)
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_3_0(ARGS)
#DIMS マス番号
マス番号 = 3_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		IF ダンジョン内一時変数:0 == 0
			ダンジョンマス画像URL_重ね表示 = えっちハート
		ENDIF
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "7_0")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			IF ダンジョン内一時変数:0 == 0
				CALL ダンジョンハプニング基本処理()
				IF RESULT
					ダンジョン内一時変数:0 = 1
				ENDIF
				CALL 口上変数初期化
			ENDIF
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 「던전을 걷다 보면, 가끔 해프닝에 조우할 때가 있다」
			WSTR:(K++) = 「물론 네가 가장 좋아하는 야한 해프닝 말이야」
			KSTR:(K++) = 「자, 시작한다」
			CALL メッセージ欄表示用関数("顔エラ","星晶獣era")
			CALL ダンジョンハプニング基本処理()
			IF RESULT
				CALL 口上変数初期化
				WSTR:(K++) = 「이런 해프닝은 몇 가지 종류가 있다」
				WSTR:(K++) = 「대부분은 매번 무작위로 결정돼. 누가 대상이 될지, 무슨 일이 일어날지도 포함해서 말이야」
				KSTR:(K++) = 「이런 종류의 이벤트는 던전에서 나가면 부활해. 기억하고 있다면 다음에도 즐겨봐」
				CALL メッセージ欄表示用関数("顔エラ","星晶獣era")
				ダンジョン内一時変数:0 = 1
			ELSE
				CALL 口上変数初期化
				WSTR:(K++) = 「……가끔은 이런 일도 있어」
				WSTR:(K++) = 「그럴 때는 다시 한번 밟아봐. 뭔가 일어날지도 몰라」
				CALL メッセージ欄表示用関数("顔エラ","星晶獣era")
			ENDIF
			CALL 口上変数初期化
			
			SETBIT ダンジョン構造配列_沿岸部の森:7:0, 1
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_7_0(ARGS)
#DIMS マス番号
マス番号 = 7_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = 右アイコン
	CASE "接続先"
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 「화살표 아이콘이 뜨는 칸은 던전 내의 다른 지역으로 이동할 수 있어」
			KSTR:(K++) = 「더 나아가면 새로운 아이템이나 강적과 마주할 수 있을 거야」_PAGE
			WSTR:(K++) = 「던전 내에 있는 특기할 만한 아이콘은 대략 이상의 4가지야」
			KSTR:(K++) = 「물론 예외는 있지만…… 그걸 보는 건 좀 더 나중의 일일 거야」_PAGE
			KSTR:(K++) = 「그럼 탐색을 계속해서 힘내봐. 응원하고 있어, 나의 계약자」
			CALL メッセージ欄表示用関数("顔エラ","星晶獣era")
			CALL 口上変数初期化
			SETBIT ダンジョン構造配列_沿岸部の森:8:0, 1
			SETBIT ダンジョン構造配列_沿岸部の森:8:0, 2
			SETBIT ダンジョン構造配列_沿岸部の森:9:0, 1
			SETBIT ダンジョン構造配列_沿岸部の森:9:3, 1
		ENDIF
		ダンジョン現在位置:0 = 8
		ダンジョン現在位置:1 = 0
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_8_0(ARGS)
#DIMS マス番号
マス番号 = 8_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = 左アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "9_0")
		CALL ダンジョン分岐線描画(マス番号, "9_3")
	CASE "マスイベント"
		ダンジョン現在位置:0 = 7
		ダンジョン現在位置:1 = 0
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_9_0(ARGS)
#DIMS マス番号
マス番号 = 9_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "10_0")
		CALL ダンジョン分岐線描画(マス番号, "10_1")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			KSTR:(K++) = 숲의 짐승 길을 똑바로 나아가자, 앞길이 두 갈래로 나뉘어 있었다.
			KSTR:(K++) = 천천히 바람이 안쪽으로 흘러가는 것을 느낀다.
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 숲의 짐승 길을 똑바로 나아가자, 앞길이 두 갈래로 나뉘어 있었다.
			WSTR:(K++) = 천천히 바람이 안쪽으로 흘러가는 것을 느낀다.
			KSTR:(K++) = 안쪽에 바람 속성 에너미가 많이 있을지도 모른다. 조심해서 나아가자.
			CALL メッセージ欄表示用関数()
			CALL 口上変数初期化
			SETBIT ダンジョン構造配列_沿岸部の森:10:0, 1
			SETBIT ダンジョン構造配列_沿岸部の森:10:1, 1
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_10_0(ARGS)
#DIMS マス番号
マス番号 = 10_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "11_0")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			敵BATTLE_STATE_STR:0:エネミー名 = Lv2_風のエレメンタル
			敵BATTLE_STATE_STR:1:エネミー名 = Lv2_風のエレメンタル
			CALL 雑魚敵繰り返し戦闘処理
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 길을 나아갈 때마다, 바람이 강해지고 있는 것을 느낀다……
			KSTR:(K++) = ……아니, 이 강함은 자연의 바람이 아니다! 정령계의 적이다!
			CALL メッセージ欄表示用関数()
			
			敵BATTLE_STATE_STR:0:エネミー名 = Lv2_風のエレメンタル
			敵BATTLE_STATE_STR:1:エネミー名 = Lv2_風のエレメンタル
			CALL 雑魚敵遭遇汎用処理
			SETBIT ダンジョン構造配列_沿岸部の森:11:0, 1
		ENDIF
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_沿岸部の森_11_0(ARGS)
#DIMS マス番号
マス番号 = 11_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		IF GETBIT(ダンジョン構造配列_沿岸部の森:11:0, 4)
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
		ELSE
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱
		ENDIF
	CASE "接続先"
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			KSTR:(K++) = 상자는 텅 비어있다.
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 길의 막다른 곳에서, 정령의 마력이 굳어진 돌을 발견했다.
			WSTR:(K++) = 대부분은 쓸모없는 돌이지만, 그중에는 쓸 수 있을 것 같은 마석도 섞여있다.
			KSTR:(K++) = %CALLNAME:PLAYER%은(는) 마석을 2개 손에 넣었다!
			CALL メッセージ欄表示用関数()

			CALL 口上変数初期化
			CALL アイテム増減汎用処理("魔石", 2)
			SETBIT ダンジョン構造配列_沿岸部の森:11:0, 4
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_10_1(ARGS)
#DIMS マス番号
マス番号 = 10_1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		IF GETBIT(ダンジョン構造配列_沿岸部の森:11:1, 1) || GETBIT(ダンジョン構造配列_沿岸部の森:11:2, 1)
		ELSE
			ダンジョンマス画像URL_重ね表示 = 会話アイコン
		ENDIF
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "11_1")
		CALL ダンジョン分岐線描画(マス番号, "11_2")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF GETBIT(ダンジョン構造配列_沿岸部の森:11:1, 1) || GETBIT(ダンジョン構造配列_沿岸部の森:11:2, 1)
			KSTR:(K++) = 더 이상 짐승의 모습은 없다. 어딘가로 사라진 것 같다.
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
			;最初に訪れた時
			IF 初来訪マス判定用フラグ
				WSTR:(K++) = 던전을 나아가고 있는데, 고양이 같은 짐승이 너희들 앞에 나타났다.
				WSTR:(K++) = 짐승은 부상을 입고 있으며, 오른쪽 앞발에 아파 보이는 상처가 있다.
				KSTR:(K++) = 안쪽 길로 나아가지 못하도록 너희들을 위협하고 있는 것 같다。_PAGE
			ELSE
				WSTR:(K++) = 짐승은 여전히 너희들을 위협하며 안쪽 길로 나아가지 못하게 하고 있다.
			ENDIF
			WSTR:(K++) = 적도 아닌 그저 짐승. 나아가려고 한다면 간단하겠지만……
			KSTR:(K++) = BUTTON_[무시하고 안쪽으로 나아가다]
			KSTR:(K++) = BUTTON_[짐승에게 약초를 사용하다]
			KSTR:(K++) = BUTTON_[왔던 길로 되돌아가다]
			CALL メッセージ欄表示用関数(,,,0)
			$LOOP_MESSAGE
			INPUTS
			SELECTCASE RESULTS
				CASE "[無視して奥へと進む]"
					CALL 口上変数初期化
					WSTR:(K++) = 짐승을 밀치고 무시한 채 안쪽으로 나아간다.
					WSTR:(K++) = 지나가던 길에 몇 마리의 새끼 고양이를 발견했다. 짐승은 이 아이들을 지키고 있었던 모양이다.
					KSTR:(K++) = 하지만 너희와는 상관없는 일이다. 그대로 안쪽 길로 나아간다.
					CALL メッセージ欄表示用関数()
					SETBIT ダンジョン構造配列_沿岸部の森:11:1, 1
				CASE "[獣に薬草を使う]"
					CALL 口上変数初期化
					CALL アイテム増減汎用処理("薬草", -1)
					IF RESULT
						WSTR:(K++) = 짐승에게 천천히 다가가, 가지고 있는 약초를 보여준다.
						WSTR:(K++) = 냄새를 맡은 짐승은 위협을 멈추고, 너희를 가만히 응시하고 있다.
						KSTR:(K++) = %CALLNAME:(BATTLE_STATE:0:キャラ登録番号)%은(는) 재빨리 짐승의 상처에 약초를 사용하여 치료했다._PAGE
						WSTR:(K++) = 짐승은 온화한 목소리로 한 번 울고, 수풀 속으로 이동한다.
						WSTR:(K++) = 짐승의 뒤를 따라가자, 그곳에는 나무 그림자에 가려진 샛길이 있었다.
						KSTR:(K++) = 방향으로 보아 숲 안쪽으로 이동하기 위한 지름길이 될 것이다._PAGE
						KSTR:(K++) = 너희가 감사를 표하자 짐승은 다시 한 번 울고, 어딘가로 사라졌다.
						CALL メッセージ欄表示用関数()
						SETBIT ダンジョン構造配列_沿岸部の森:11:1, 1
						SETBIT ダンジョン構造配列_沿岸部の森:11:2, 1
					ENDIF
				CASE "[元来た道を引き返す]"
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE
			ENDSELECT
			CALL 口上変数初期化
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_11_1(ARGS)
#DIMS マス番号
マス番号 = 11_1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			敵BATTLE_STATE_STR:0:エネミー名 = Lv2_風のエレメンタル
			敵BATTLE_STATE_STR:1:エネミー名 = Lv2_風のエレメンタル
			敵BATTLE_STATE_STR:2:エネミー名 = Lv2_風のエレメンタル
			CALL 雑魚敵繰り返し戦闘処理
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 길의 막다른 곳에는, 회오리바람 같은 바람의 흐름이 휘몰아치고 있었다.
			WSTR:(K++) = 정령계의 적들이 모여, 주위를 바람의 칼날로 휩쓸고 있는 것 같다.
			KSTR:(K++) = 그것들은 분별없이 날뛰며, 너희들에게도 덮쳐온다!
			CALL メッセージ欄表示用関数()
			
			敵BATTLE_STATE_STR:0:エネミー名 = Lv2_風のエレメンタル
			敵BATTLE_STATE_STR:1:エネミー名 = Lv2_風のエレメンタル
			敵BATTLE_STATE_STR:2:エネミー名 = Lv2_風のエレメンタル
			CALL 雑魚敵遭遇汎用処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_11_2(ARGS)
#DIMS マス番号
マス番号 = 11_2

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "14_2")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
		ELSE
			;最初に訪れた時
			SETBIT ダンジョン構造配列_沿岸部の森:14:2, 1
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_9_3(ARGS)
#DIMS マス番号
マス番号 = 9_3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "11_3")
		CALL ダンジョン分岐線描画(マス番号, "10_4")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			KSTR:(K++) = 부서진 바위가 몇 개 굴러다니고 있다.
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
			;最初に訪れた時
			KSTR:(K++) = 숲 속을 탐색하다가, 부서진 바위를 몇 개 발견했다.
			WSTR:(K++) = 스톤 이터의 식사 흔적임에 틀림없다.
			KSTR:(K++) = 목표로 가는 길은 이쪽이 맞는 것 같다. 조심해서 나아가자.
			CALL メッセージ欄表示用関数()
			CALL 口上変数初期化
			SETBIT ダンジョン構造配列_沿岸部の森:11:3, 1
			SETBIT ダンジョン構造配列_沿岸部の森:10:4, 1
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_11_3(ARGS)
#DIMS マス番号
マス番号 = 11_3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		IF GETBIT(ダンジョン構造配列_沿岸部の森:11:3, 2)
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
		ELSE
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱
		ENDIF
	CASE "接続先"
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			KSTR:(K++) = 상자는 텅 비어있다.
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 부서진 바위 속에서, 반짝이는 것을 발견한다.
			WSTR:(K++) = 마력이 깃든 금속이다. 간단히 깎아서 장식을 붙이면 귀걸이가 될 것이다.
			KSTR:(K++) = 귀걸이는 개인의 속성을 바꿀 수 있다. 스톤 이터를 쓰러뜨리는 데 도움이 될지도 모른다._PAGE
KSTR:(K++) = %CALLNAME:PLAYER%은(는) 바람의 귀걸이를 손에 넣었다!
			CALL メッセージ欄表示用関数()
			CALL 汎用耳飾り取得処理("風の耳飾り")
			CALL 口上変数初期化
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_10_4(ARGS)
#DIMS マス番号
マス番号 = 10_4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "11_5")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			敵BATTLE_STATE_STR:0:エネミー名 = Lv2_ゴブリン
			敵BATTLE_STATE_STR:2:エネミー名 = Lv2_風のエレメンタル
			敵BATTLE_STATE_STR:4:エネミー名 = Lv2_ゴブリン
			CALL 雑魚敵繰り返し戦闘処理
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 앞으로 나아가는 너희들 앞에, 마물들이 가로막는다.
			KSTR:(K++) = 미개발 지역이라고는 해도 리조트가 있는 섬에 마물이 많으면 곤란하다. 가능한 한 쓰러뜨리고 나아가자.
			CALL メッセージ欄表示用関数()
			
			敵BATTLE_STATE_STR:0:エネミー名 = Lv2_ゴブリン
			敵BATTLE_STATE_STR:2:エネミー名 = Lv2_風のエレメンタル
			敵BATTLE_STATE_STR:4:エネミー名 = Lv2_ゴブリン
			CALL 雑魚敵遭遇汎用処理
			SETBIT ダンジョン構造配列_沿岸部の森:11:5, 1
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_11_5(ARGS)
#DIMS マス番号
マス番号 = 11_5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "12_5")
	CASE "マスイベント"
		CALL 口上変数初期化
		KSTR:(K++) = 바람이 잎을 흔들며, 살랑살랑 귀에 기분 좋은 소리를 내고 있다.
		CALL メッセージ欄表示用関数(,,,0)
		IF 初来訪マス判定用フラグ
			SETBIT ダンジョン構造配列_沿岸部の森:12:5, 1
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_12_5(ARGS)
#DIMS マス番号
マス番号 = 12_5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "13_4")
		CALL ダンジョン分岐線描画(マス番号, "13_6")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
		ELSE
			SETBIT ダンジョン構造配列_沿岸部の森:13:4, 1
			SETBIT ダンジョン構造配列_沿岸部の森:13:6, 1
			WSTR:(K++) = 길이 두 갈래로 나뉘어 있다.
			WSTR:(K++) = 위쪽 길에는 드문드문 부스러기 돌이 흩어져 있다. 스톤 이터는 이쪽에 있을 것이다.
			KSTR:(K++) = 아래쪽 길에서는 물소리가 들려온다. 강이 흐르고 있는 것 같다.
			CALL メッセージ欄表示用関数()
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_13_6(ARGS)
#DIMS マス番号
マス番号 = 13_6

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		IF GETBIT(ダンジョン構造配列_沿岸部の森:13:6, 5)
			ダンジョンマス画像URL_重ね表示 = エネミーアイコン
		ELSE
			ダンジョンマス画像URL_重ね表示 = 会話アイコン
		ENDIF
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "14_6")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			敵BATTLE_STATE_STR:0:エネミー名 = Lv3_스니퍼
			敵BATTLE_STATE_STR:1:エネミー名 = Lv3_스니퍼
			CALL 雑魚敵繰り返し戦闘処理
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 조금 나아가자 숲속을 흐르는 강이 나왔다.
			WSTR:(K++) = 물은 맑았고, 가끔 물고기가 뛰어오르는 모습이 보였다.
			KSTR:(K++) = 스톤 이터는 이쪽으로는 오지 않는 건지, 편히 앉기 좋은 바위가 몇 개 굴러다녔다._PAGE
			KSTR:(K++) = 잠시 쉬어갈까요?
			KSTR:(K++) = BUTTON_[예]
			KSTR:(K++) = BUTTON_[아니요]
			CALL メッセージ欄表示用関数(,,,0)
			$LOOP_MESSAGE_2
			INPUTS
			SELECTCASE RESULTS
				CASE "[はい]"
					CALL 口上変数初期化
					WSTR:(K++) = 마침 걷느라 지쳐있던 참이었던 %CALLNAME:PLAYER%은 휴식을 제안한다.
					KSTR:(K++) = 모두 바위에 앉아, 보존식을 꺼내 휴식했다.
					CALL メッセージ欄表示用関数()
					CALL 口上変数初期化
					KSTR:(K++) = 모두의 HP가 50, MP가 30 회복.
					FOR LOCAL, 0, 4
						IF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
							BREAK
						ENDIF
						BATTLE_STATE:LOCAL:ＨＰ = MIN(BATTLE_STATE:LOCAL:ＨＰ + 50, BATTLE_STATE:LOCAL:最大ＨＰ)
						BATTLE_STATE:LOCAL:ＭＰ = MIN(BATTLE_STATE:LOCAL:ＭＰ + 30, BATTLE_STATE:LOCAL:最大ＭＰ)
					NEXT
					CALL メッセージ欄表示用関数()
					CALL 口上変数初期化
					WSTR:(K++) = ……잠시 쉬고 있자, 주위에 기척을 느낀다.
					WSTR:(K++) = 이 물가를 영역으로 삼고 있는 마물들이 모여, 어느새 너희를 둘러싸고 있다!
					KSTR:(K++) = 다수의 마물들이 너희에게 덮쳐왔다!
					CALL メッセージ欄表示用関数()
					敵BATTLE_STATE_STR:4:エネミー名 = Lv3_스니퍼
					敵BATTLE_STATE_STR:7:エネミー名 = Lv3_스니퍼
				CASE "[いいえ]"
					CALL 口上変数初期化
					WSTR:(K++) = 물가는 마물이 모이기 쉬운 장소다. 무방비하게 쉬는 것은 위험할지도 모른다.
WSTR:(K++) = %CALLNAME:PLAYER%들이 주변을 조사해 보니, 역시 마물이 몇 마리 살고 있었다.
KSTR:(K++) = 쉬는 것은 마물을 제거한 후에 하자.
					CALL メッセージ欄表示用関数()
					SETBIT ダンジョン構造配列_沿岸部の森:13:6, 4
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE_2
			ENDSELECT
			
			敵BATTLE_STATE_STR:0:エネミー名 = Lv3_スニッパー
			敵BATTLE_STATE_STR:1:エネミー名 = Lv3_スニッパー
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0 && GETBIT(ダンジョン構造配列_沿岸部の森:13:6, 4)
				CALL 口上変数初期化
KSTR:(K++) = 마물을 물리쳐 안전을 확보한 후, 너희는 보존식을 꺼내 휴식했다.
				CALL メッセージ欄表示用関数()
				CALL 口上変数初期化
KSTR:(K++) = 모두의 HP가 50, MP가 30 회복.
				FOR LOCAL, 0, 4
					IF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
						BREAK
					ENDIF
					BATTLE_STATE:LOCAL:ＨＰ = MIN(BATTLE_STATE:LOCAL:ＨＰ + 50, BATTLE_STATE:LOCAL:最大ＨＰ)
					BATTLE_STATE:LOCAL:ＭＰ = MIN(BATTLE_STATE:LOCAL:ＭＰ + 30, BATTLE_STATE:LOCAL:最大ＭＰ)
				NEXT
				CALL メッセージ欄表示用関数()
			ENDIF
			SETBIT ダンジョン構造配列_沿岸部の森:13:6, 5
			SETBIT ダンジョン構造配列_沿岸部の森:14:6, 1
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_14_6(ARGS)
#DIMS マス番号
マス番号 = 14_6

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		IF GETBIT(ダンジョン構造配列_沿岸部の森:14:6, 4)
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
		ELSE
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱
		ENDIF
	CASE "接続先"
	CASE "マスイベント"
		CALL 口上変数初期化
		IF GETBIT(ダンジョン構造配列_沿岸部の森:14:6, 4)
KSTR:(K++) = 특별한 것은 아무것도 없다.
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
WSTR:(K++) = 강가를 따라가자, 나뭇가지와 흙으로 만들어진 둥지 같은 것이 있었다.
WSTR:(K++) = 아까 그 게 마물의 둥지일까. 둥지 주인은 외출한 듯, 여기에는 없다.
KSTR:(K++) = ……둥지 안에, 반짝이는 것을 발견했다_PAGE
WSTR:(K++) = 마력이 담긴 반지인 듯하다.
WSTR:(K++) = 반지를 장비하면, 스테이터스를 크게 상승시킬 수 있다.
KSTR:(K++) = 스트론 이터 토벌에 도움이 될 것이다. 게에게는 필요 없을 테니, 가져가자._PAGE
KSTR:(K++) = 「영광의 반지・힘」을 손에 넣었다!_PAGE
			CALL メッセージ欄表示用関数()
			CALL 汎用指輪取得処理("栄冠の指輪・力", 0)
			SETBIT ダンジョン構造配列_沿岸部の森:14:6, 4
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_13_4(ARGS)
#DIMS マス番号
マス番号 = 13_4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "14_2")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			敵BATTLE_STATE_STR:0:エネミー名 = Lv2_ゴブリン
			敵BATTLE_STATE_STR:3:エネミー名 = Lv2_ゴブリン
			敵BATTLE_STATE_STR:4:エネミー名 = Lv2_ゴブリン
			敵BATTLE_STATE_STR:7:エネミー名 = Lv2_ゴブリン
			CALL 雑魚敵繰り返し戦闘処理
		ELSE
			;最初に訪れた時
			KSTR:(K++) = 마물의 무리가 나타났다!
			CALL メッセージ欄表示用関数()
			
			敵BATTLE_STATE_STR:0:エネミー名 = Lv2_ゴブリン
			敵BATTLE_STATE_STR:3:エネミー名 = Lv2_ゴブリン
			敵BATTLE_STATE_STR:4:エネミー名 = Lv2_ゴブリン
			敵BATTLE_STATE_STR:7:エネミー名 = Lv2_ゴブリン
			CALL 雑魚敵遭遇汎用処理
			SETBIT ダンジョン構造配列_沿岸部の森:14:2, 1
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_14_2(ARGS)
#DIMS マス番号
マス番号 = 14_2

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "15_0")
	CASE "マスイベント"
		CALL 口上変数初期化
		IF 初来訪マス判定用フラグ == 0
			KSTR:(K++) = 전방에 나무들의 틈이 보이기 시작했다.
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 전방에 나무들의 틈이 보이기 시작했다, 슬슬 숲을 빠져나갈 때가 되었을 것이다.
			WSTR:(K++) = 떨어져 있는 부스러기 돌이 많아지고 있다. 스톤 이터가 근처에 있을 것이다.
			KSTR:(K++) = 만약 다쳤다면, 회복하고 나서 나아가는 편이 좋을지도 모른다.
			CALL メッセージ欄表示用関数()
			
			SETBIT ダンジョン構造配列_沿岸部の森:15:0, 1
			SETBIT ダンジョン構造配列_沿岸部の森:15:0, 2
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_15_0(ARGS)
#DIMS マス番号
マス番号 = 15_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = 右アイコン
	CASE "接続先"
	CASE "マスイベント"
		CALL 口上変数初期化
		ダンジョン現在位置:0 = 16
		ダンジョン現在位置:1 = 0
		SETBIT ダンジョン構造配列_沿岸部の森:16:0, 1
		SETBIT ダンジョン構造配列_沿岸部の森:16:0, 2
		SETBIT ダンジョン構造配列_沿岸部の森:17:0, 1
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_沿岸部の森_16_0(ARGS)
#DIMS マス番号
マス番号 = 16_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		ダンジョンマス画像URL_重ね表示 = 左アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(マス番号, "17_0")
	CASE "マスイベント"
		CALL 口上変数初期化
		ダンジョン現在位置:0 = 15
		ダンジョン現在位置:1 = 0
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_沿岸部の森_17_0(ARGS)
#DIMS マス番号
マス番号 = 17_0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_草原
		IF ダンジョン内一時変数:1 == 0
			ダンジョンマス画像URL_重ね表示 = エネミーアイコン_赤
		ENDIF
	CASE "接続先"
	CASE "マスイベント"
		CALL 口上変数初期化
		IF ダンジョンクリアフラグ_沿岸部の森
			IF ダンジョン内一時変数:1 == 0
				KSTR:(K++) = 스톤 이터와의 싸움의 기억을 떠올리시겠습니까?
				KSTR:(K++) = (보스와 재전)
				KSTR:(K++) = BUTTON_[예]
				KSTR:(K++) = BUTTON_[아니오]
				CALL メッセージ欄表示用関数(,,,0)
				$LOOP_MESSAGE
				INPUTS
				SELECTCASE RESULTS
					CASE "[はい]"
						敵BATTLE_STATE_STR:0:エネミー名 = Lv6_스톤 이터
						CALL 雑魚敵遭遇汎用処理
						IF RESULT == 0
							CALL 口上変数初期化
							LOCAL = RAND:5
							SELECTCASE LOCAL
								CASE 0
									WSTR:(K++) = 스톤 이터에게서 「영광의 반지・무게」을(를) 손에 넣었다!
									CALL 汎用指輪取得処理("栄冠の指輪・重", 1)
								CASE 1
									WSTR:(K++) = 스톤 이터에게서 「영광의 반지・속도」을(를) 손에 넣었다!
									CALL 汎用指輪取得処理("栄冠の指輪・速", 1)
								CASE 2
									WSTR:(K++) = 스톤 이터에게서 「영광의 반지・벽」을(를) 손에 넣었다!
									CALL 汎用指輪取得処理("栄冠の指輪・壁", 1)
								CASE 3
									WSTR:(K++) = 스톤 이터에게서 「영광의 반지・치유」을(를) 손에 넣었다!
									CALL 汎用指輪取得処理("栄冠の指輪・癒", 1)
								CASE 4
									WSTR:(K++) = 스톤 이터에게서 「영광의 반지・힘」을(를) 손에 넣었다!
									CALL 汎用指輪取得処理("栄冠の指輪・力", 1)
							ENDSELECT
							KSTR:(K++) = 스톤 이터에게서 「불의 귀걸이」을(를) 손에 넣었다!
							CALL 汎用耳飾り取得処理("火の耳飾り")
							CALL メッセージ欄表示用関数()
							ダンジョン内一時変数:1 = 1
						ENDIF
					CASE "[いいえ]"
						CALL 口上変数初期化
					CASEELSE
						CLEARLINE 1
						REUSELASTLINE  
						GOTO LOOP_MESSAGE
				ENDSELECT
			ENDIF
		ELSE
			;最初に訪れた時
			WSTR:(K++) = %CALLNAME:PLAYER%들이 숲의 깊은 곳으로 발을 들여놓자, 그곳에는 땅을 파헤쳐 돌을 갉아먹는 도마뱀 마물이 있었다.
			WSTR:(K++) = 이 녀석이 목표인 「스톤 이터」임에 틀림없을 것이다.
			WSTR:(K++) = 싸울 준비는 되었는가?
			KSTR:(K++) = BUTTON_[예]
			KSTR:(K++) = BUTTON_[아니오]
			CALL メッセージ欄表示用関数(,,,0)
			$LOOP_MESSAGE_BOSS
			INPUTS
			SELECTCASE RESULTS
				CASE "[はい]"
					CALL 口上変数初期化
					KSTR:(K++) = 너희는 무기를 들고, 스톤 이터에게 싸움을 걸었다!
					CALL メッセージ欄表示用関数()
					敵BATTLE_STATE_STR:0:エネミー名 = Lv6_스톤 이터
					CALL BATTLE_MAIN_LOOP

					IF RESULT == 0
						;勝利時
						ダンジョン表示モード = マップ画面
						CALL 口上変数初期化
						WSTR:(K++) = %CALLNAME:PLAYER%은(는) 스톤 이터 토벌에 성공했다!!
						KSTR:(K++) = 이것으로 공사업자를 부를 수 있게 되었다. 즉시 돌아가서, 만물상에 편지를 보내자…_PAGE
						WSTR:(K++) = ・[시설 개조] 기능이 해방되었다!
						WSTR:(K++) = ・[직원 설정] 기능이 해방되었다!
						WSTR:(K++) = ・[공정항] 맵이 해방되었다!
						WSTR:(K++) = ・[400] 이동 커맨드 내에 "다른 지역으로 이동한다" 기능이 해방되었다!
						WSTR:(K++) = ・스톤 이터에게서 "영광의 반지・힘"을 손에 넣었다!
						WSTR:(K++) = ・스톤 이터에게서 "불의 귀걸이"를 손에 넣었다!
						CALL 汎用指輪取得処理("栄冠の指輪・力", 2)
						CALL 汎用耳飾り取得処理("火の耳飾り")
						WSTR:(K++) = 연안부 숲을 클리어했습니다, 귀환합니다.
						CALL メッセージ欄表示用関数()
						探索中全体カウント:追加信頼度 += 500
						ダンジョン終了状況 = 討伐達成
						ダンジョンクリアフラグ_沿岸部の森 = 1
					ELSEIF RESULT == 1
						;全滅時
						ダンジョン表示モード = マップ画面
						CALL 口上変数初期化
						KSTR:(K++) = %CALLNAME:PLAYER%은(는) 힘이 다한 동료들을 데리고, 간신히 도망쳤다…
						CALL メッセージ欄表示用関数()
						ダンジョン終了状況 = 全滅
					ELSEIF RESULT == -1
						;逃走時
						ダンジョン表示モード = マップ画面
					ENDIF
					VARSET 敵BATTLE_STATE:0:0
					VARSET 敵BATTLE_STATE_STR:0:0
				CASE "[いいえ]"
					CALL 口上変数初期化
					KSTR:(K++) = 너희는 준비를 갖추기 위해, 일단 그곳을 떠났다……
					CALL メッセージ欄表示用関数()
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE_BOSS
			ENDSELECT
			CALL 口上変数初期化
		ENDIF
		CALL 画面再描画
ENDSELECT
