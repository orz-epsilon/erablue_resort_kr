;--------------------------------------------------
;ダンジョン探索中に条件を満たしていた時表示される文章
;--------------------------------------------------
;・使い方
;「25」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;--------------------------------------------------

;--------------------------------------------------
;「仲間と会話」ボタン押下時
;--------------------------------------------------
@KOJO_DUNGEON_仲間と会話_25(対象キャラ)
#DIM 対象キャラ
;簡単に何度も見られるので、条件分岐やランダム化で複数パターンの登録を推奨
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

SELECTCASE RAND:3 + RAND:3
	CASE 0
		WSTR:(K++) = 「_I_어이쿠, 나만 쳐다보지 말고 주변도 경계해라_CALL_カリオストロ本性開示_」
		KSTR:(K++) = %CALLNAME:対象キャラ%은(는) 심술궂은 미소를 짓고 있다
	CASE 1
		WSTR:(K++) = %CALLNAME:対象キャラ%은(는) 주위를 살피고 있다……
		KSTR:(K++) = 「_I_음, 뭔가 쓸 만한 재료는……」
	CASE 2
		WSTR:(K++) = 「음~? %CSTR:対象キャラ:二人称%님, 무슨 일이에요?」
		KSTR:(K++) = %CALLNAME:対象キャラ%은(는) 고개를 갸웃거리고 있다
	CASE 3
		WSTR:(K++) = _CALLNAME_은(는) 근심 어린 표정으로 한숨을 쉬고 있다……
		KSTR:(K++) = 「아, _2nd_님, 어땠어요? 방금 표정, 색다른 귀여움이었죠♪」
	CASE 4
		WSTR:(K++) = 「_I_어이%CSTR:対象キャラ:二人称%, 너무 나에게서 떨어지지 마라_」
		KSTR:(K++) = 「_I_내가 있는데 다치기라도 하면, 체면에 금이 가니까 말이야_CALL_カリオストロ本性開示_」
ENDSELECT

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ,,0,,対象キャラ)



;--------------------------------------------------
;固有スキル発動時
;--------------------------------------------------
;「（キャラ名）の（アビ名）！」よりも前に表示される
;汎用アビや衣装アビだと発動しないので注意

;YYYYを固有アビ関数の「@固有アビ_25_YYYY」のYYYYと同じに変更する
;使用したアビリティの名前は「使用アビ名」に入ってくる
@KOJO_DUNGEON_固有アビ発動時_25_1(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;コラプス→ニュークリアシンサシス

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「흥흥☆」
	DATA 「장난칠 거야☆」
	DATA 「포상이야☆」
	DATA 「벌 줄 거야☆」
	DATA 「_I_놀아줄게_」
	DATA 「_I_한 번에 해치워주마!_」
	DATA 「_I_기쁘지? 귀여운 여자아이에게 농락당하다니 말이야!_」
	DATA 「_I_괄목하라! 이것이 귀여움이라는 것이다!_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_2(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;ファンタスマゴリア→アルケイナ・エボリューション

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「칼리오스트로, 알겠어♪」
	DATA 「네 멋진 모습, 더 보고 싶어_H_」
	DATA 「딴 데 보면 안 돼_H_」
	DATA 「서포트라면 맡겨줘☆」
	DATA 「_I_좋아하는 거지? 이런 여자아이가 말이야~_」
	DATA 「_I_너, 나에게 설레고 있는 거지?_」
	DATA 「_I_이런 건 기초 중의 기초라고_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_3(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;リーンフォース→ネフシュタン

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「수고했어☆」
	DATA 「아직 쓰러지면 안 돼~☆」
	DATA 「손수 발 벗고, 고쳐줄게♪」
	DATA 「힘내_H_ 힘내_H_」
	DATA 「파이팅☆ 파이팅☆」
	DATA 「_I_세계 제일의 미소녀가 치유해 줄게_」
	DATA 「_I_아직 할 수 있잖아?_」
	DATA 「_I_이러니저러니 해도, 아직 더 할 수 있을 것 같잖아_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_11(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;アルス・グローリア

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「_I_연금술의 극치를 보여주마!_」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_12(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;エンデュミオン

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「칼리오스트로를 위해 힘내_H_」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_13(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;ロード・トゥ・ジオメトリ

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「폭력 반대☆」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;奥義発動時
;--------------------------------------------------
@KOJO_DUNGEON_奥義発動時_25(対象キャラ, 使用奥義名)
#DIMS 使用奥義名
#DIM 対象キャラ
;「（キャラ名）の奥義：（奥義名）！」よりも前に表示される

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

IF 基礎BATTLE_STATE:LOCAL:Lv >= 35
	IF !RAND:4 && 陥落チェック(LOCAL)
		KSTR:(K++) = 「_I_잘 가라! 네놈은 여기서 종신형이다!!_」
	ELSEIF !RAND:3
		KSTR:(K++) = 「_I_이것이 연금술의 극치다!_」
	ELSE
		KSTR:(K++) = 「_I_진리 앞에 무릎 꿇어라!_」
	ENDIF
ELSE
	KSTR:(K++) = 「이것이 진리의…_I_일격이다!_」
ENDIF

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ,,0,,対象キャラ)

;--------------------------------------------------
;チェンバースト発動時
;--------------------------------------------------
@KOJO_DUNGEON_チェンバ発動時_25(対象キャラ)
#DIM 対象キャラ
VARSET LOCAL
;「チェインバースト！」（フルチェイン！）よりも前に表示される
;該当キャラが起点になった時（＝ターンで最初に奥義を撃ったキャラ）しか呼ばれないので注意

CALL 口上変数初期化
VARSET LOCAL
LOCAL = キャラ隊列検索(対象キャラ)
LOCALS '= ""
LOCAL:2 = キャラ検索("[未完の錬金術師]クラリス")
LOCAL:3 = キャラ検索("[希求の錬金術師]ミレイユ")
LOCAL:4 = キャラ検索("[ミレイユの従者]リゼット")
LOCAL:12 = キャラ隊列検索(LOCAL:2) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:2))
LOCAL:13 = キャラ隊列検索(LOCAL:3) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:3))
LOCAL:14 = キャラ隊列検索(LOCAL:4) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:4))
IF LOCAL:12 || LOCAL:13 || LOCAL:14
	SIF LOCAL:12
		LOCALS += "클라리스,"
	SIF LOCAL:13
		LOCALS += "미레이유,"
	SIF LOCAL:14
		LOCALS += "리제트,"
	KSTR:(K++) = 「_I_%LOCALS%숨을 맞춰라! 단숨에 몰아붙인다!!_」
	IF LOCAL:12
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:2)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:2)}_顔
		KSTR:(K++) = 「으, 응! 알았어 스승님!!」
		LOCAL:1 ++
	ENDIF
	IF LOCAL:13
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:3)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:3)}_顔
		KSTR:(K++) = 「알겠습니다 선생님!」
		LOCAL:1 ++
	ENDIF
	IF LOCAL:14
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:4)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:4)}_顔
		KSTR:(K++) = 「알겠습니다!」
		LOCAL:1 ++
	ENDIF
ELSE
	KSTR:(K++) = 「_I_잉여 마력이 완전히 소산되기 전에, 다시 모아서 때려박는다!!_」
ENDIF

;掛け合いの作り方
;ZZZZ = 掛け合い相手のCSVに記載してあるキャラ番号とする
;
; LOCAL:2 = GETCHARA(ZZZZ)
; IF キャラ隊列検索(LOCAL:2) > -1
; 	KSTR:(K++) = （口上キャラのセリフ）
;
; 	NSTR:(K++) = ++++
;	切り替え名前:0 = %CALLNAME:(LOCAL:2)%
; 	切り替え顔グラリソース:0 = 探索用_{キャラ隊列検索(LOCAL:2)}_顔
;
; 	KSTR:(K++) = （掛け合い相手のセリフ）
; ENDIF
;と記述すると下に一個、掛け合い相手の顔グラと名前が表示されたメッセージ欄を増やせるので、そこで掛け合いを行う
;複数個メッセージ欄を増やす場合、切り替え顔グラリソース:1、切り替え名前:1のように配列番号を１つずつ増やすこと

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;トドメ時
;--------------------------------------------------
@KOJO_DUNGEON_トドメ時_25(対象キャラ)
#DIM 対象キャラ

;行動の結果（◯◯は倒れた！など）の後に表示される
;複数攻撃時は一人でも倒していれば表示される

;口上用トドメフラグ には倒した敵の数が入っている
;口上用技名保存 には奥義名・アビ名が入っている
;       通常攻撃の場合は「通常攻撃」、チェンバの場合は「チェインバースト」が入っている

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「해냈다☆」
	DATA 「미안해?」
	DATA 「이제… 잡몹 상대는 지루해져 버려☆」
	DATA 「_I_쳇… 잡몹으론 상대가 안 되는군!_」
	DATA 「_I_조연은 어서 무대에서 내려가라_」
	DATA 「_I_잡몹은 꺼져라!_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

; ;--------------------------------------------------
; ;味方から回復を受けた時
; ;「（キャラ名）のＨＰが」の直後に表示される
; ;複数人回復した場合、ランダムで一人の分が表示される
; ;--------------------------------------------------
; ;（現在未実装）
; @KOJO_DUNGEON_被回復時_25(対象キャラ)
; #DIM 対象キャラ
; CALL 口上変数初期化
; LOCAL = GETCHARA(25)
; LOCAL:1 = キャラ隊列検索(LOCAL)

; ;回復した側のキャラは「BATTLE_STATE:戦闘行動キャラ:キャラ登録番号」でキャラ番号が
; ;「戦闘行動キャラ」で隊列番号が取れる

; KSTR:(K++) = 

; CALL メッセージ欄表示用関数(@"探索用_{LOCAL:1}_顔", CALLNAME:対象キャラ)

;--------------------------------------------------
;戦闘勝利時
;--------------------------------------------------
@KOJO_DUNGEON_戦闘勝利時_25(対象キャラ)
#DIM 対象キャラ

;ルピやEXPの取得よりも前に表示される

CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATAFORM 「칼리오스트로 열심히 했죠? %CSTR:対象キャラ:二人称%님, 칭찬해 줘 칭찬해 줘_H_」
	DATA 「아앙, 칼리오스트로, 이겨버렸어_H_」
	DATA 「에헤헷, 칼리오스트로의 승리_H_」
	DATA 「미안해… 칼리오스트로는 무적이야☆」
	DATA 「어라어라~? 벌써 끝이야?」
	DATA 「_I_말한 것만 못했군_」
	DATA 「_I_하아~ 연금술이 번뜩이는군!_」
	DATA 「_I_나에게 이기려 하다니, 천 년은 일러_」
	DATA 「_I_낙승이었군!_」
	DATA 「_I_나에게 도전한 것, 그것이 너의 패인이다_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;全滅時
;--------------------------------------------------
@KOJO_DUNGEON_全滅時_25(対象キャラ)
#DIM 対象キャラ
CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)


STRDATA KSTR:(K++)
	DATA 「흐엥~ 칼리오스트로 일행, 져버렸어~」
	DATA 「폭력 반대~」
	DATA 「_I_거짓말이지, 말도 안 돼…_」
	DATA 「_I_나님께서…_」
	DATA 「_I_제법이잖아…_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;逃走時
;--------------------------------------------------
@KOJO_DUNGEON_逃走時_25(対象キャラ)
#DIM 対象キャラ
CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「바이바이☆」
	DATA 「더 이상 상대해 줄 수 없어, 미안해?」
	DATA 「_I_쳇, 여기는 일단 물러나자!_」
	DATA 「_I_일시 철수다, 태세를 재정비하자!_」
	DATA 「_I_이대로 상대하는 건 승산이 없어, 다시 시작하자_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)
