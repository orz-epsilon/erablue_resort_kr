;-------------------------------------------------
;手マン処理
;-------------------------------------------------
@性処理NAME_手マン処理
#FUNCTIONS
TSTR:コマンド名受渡 = 수음 처리

@性処理_TOOLTIP_手マン処理
LOCALS = <br>■수음 처리<br>
LOCALS += @"%CALLNAME:PLAYER%의 클리나 질구를 손으로 애무받는 성처리. <br>"
LOCALS += "성처리 업무 중 가장 간편하고 저렴하다. <br>"
LOCALS += "<br>COM 타입: 성처리<br>획득 소스: 노출・접촉・봉사・불결"
LOCALS += "<br>고유 획득 경험: 수음 경험(TARGET)<br>"
TSTR:ツールチップ受渡 = %LOCALS%

@性処理_手マン処理
#DIM 行為回数

;射精するまで刺激する
行為回数 = 0
DO
	CALL SOURCE_CALC_快Ｃ(PLAYER, TARGET, 200)
	CALL SOURCE_CALC_快Ｖ(PLAYER, TARGET, 200)
	IF TALENT:TARGET:器用な指
		CALL SOURCE_CALC_快Ｃ(PLAYER, TARGET, 50)
		CALL SOURCE_CALC_快Ｖ(PLAYER, TARGET, 50)
	ENDIF
	行為回数++
LOOP CUP:PLAYER:快Ｃ + PALAM:PLAYER:快Ｃ < 10000 && CUP:PLAYER:快Ｖ + PALAM:PLAYER:快Ｖ < 10000
TIME += 経過時間算出(行為回数)


CALL SOURCE_CALC_露出(TARGET, PLAYER, 20)
CALL SOURCE_CALC_接触(TARGET, PLAYER, 100)
CALL SOURCE_CALC_奉仕(TARGET, PLAYER, 250)
CALL SOURCE_CALC_不潔(TARGET, PLAYER, 50)

;奉仕快楽
RCVAR:TARGET:奉仕コマンドフラグ = 1
RCVAR:TARGET:汎用喘ぎ_文節低減フラグ = 1

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;手淫経験
EXP:手淫経験 += 3

;同性愛
SIF 同性愛性癖判定(PLAYER,TARGET)
	EXP:PLAYER:同性愛経験 += 8
SIF 同性愛性癖判定(TARGET,PLAYER)
	EXP:TARGET:同性愛経験 += 8

;売春経験がない相手に交渉を成立させた場合、あなたの買春カウントが進む
;これにより「あなたが何人買ったか」の記録とする。
;最初から売春経験を持ってるキャラに関しては……知らん！！！
SIF EXP:TARGET:売春経験 == 0
	EXP:PLAYER:買春経験 += 1

EXP:TARGET:売春経験 += 1

RETURN 1


@性処理_射精時処理_手マン処理
;射精時にどこに出すかを呼び出す
;とはいってもフィニッシュ場所を入れて関数呼ぶだけ
IF GETBIT(TALENT:PLAYER:性別, 1)
	CALL 射精実処理(PLAYER, TARGET, 30)
ENDIF
RETURN 1


;-------------------------------------------------
;値段設定
;-------------------------------------------------
@CAN_性処理_手マン処理(対象キャラ)
#DIM 対象キャラ
#DIM 値段計算
#DIMS 素質名

PRINTFORML 수음 처리 계산(%CALLNAME:TARGET%)
DRAWLINE


;基礎値段
;クンニ処理を基準に1/3くらいの切りいい数字で調整してる
IF NO:TARGET > 1000
;EXキャラ
;元いた世界でのカラダの価値はわかっても、空の世界での売春相場を知らない。おまけにルピもたいして持ってないのでまとまったお金がありがたい。
;現実の一般JKが空の世界に来て1万円のつもりで1000ルピでカラダを売るイメージ。総じてリゾート内の価格帯から見ると格安。
;……グラブルキャラたちの基本料金が高いだけ？それはそう。
	SELECTCASE RAND:2
	CASE 0
	;15000円のつもり。これでもちょっと吹っ掛けたつもりで強気の値段交渉してる。
		値段計算 = 1000
	CASE 1
	;5000円のつもり。これでも相場よりちょい高めのつもりで値段交渉してる。
		値段計算 = 500
	ENDSELECT
	PRINTFORML %"基本料金", 25, LEFT%: %NUM_FORMAT(値段計算), 8%루피
ELSEIF TALENT:幼稚
	;幼稚
	;性知識うんぬん以前に、そもそもお金の価値に対する理解が足りていない。
	;自分のカラダの価値も理解していないので、「お菓子いっぱいあげるから」とかでも許しちゃったりするイメージ。でも値段表示する仕様上お菓子たくさんとかでは買えない。
	;本人は精一杯吹っ掛けているつもりで「じゅーまんえんくれるならいいよ」って言っても、他キャラの相場から見れば格安だったりする。
	;でもちょいちょい「ひゃくまんえん！」とか言いはじめる。
	SELECTCASE RAND:10
	;４割で超高額提示
	CASE 0
		PRINTFORML %"基本料金", 25, LEFT%: 십만 루피!
		値段計算 = 100000
	CASE 1 TO 3
		PRINTFORML %"基本料金", 25, LEFT%: 만 루피!
		値段計算 = 10000
	CASE 4 TO 6
		PRINTFORML %"基本料金", 25, LEFT%: 천 루피!
		値段計算 = 1000
	CASE 7 TO 9
		PRINTFORML %"基本料金", 25, LEFT%: 백 루피면 돼!
		値段計算 = 100
	ENDSELECT
ELSEIF 知識素質:高貴 > 0
;高貴
;基本的に実家が太い子らなので、そもそも目先の金銭のために体を売っているわけではない。
;お金が欲しいからではなくあなたが頼むから、あなたに喜んでんでほしいから売ってくれているのである。つまり純愛。
	IF 知識素質:性知識 < 0
	;性知識がなくとも、自身のカラダは民草のそれよりも価値があるということを知っている。
	;……のだが、相場知識がないため結局吹っ掛けたつもりでも高貴キャラとしてはお安めの価格設定
		値段計算 = 1500
	ELSE
	;王侯貴族に連なるような高貴なおくちを10万円で堪能できると考えるとこれでも結構リーズナブル。良心的な価格設定でございます。
		値段計算 = 3000
	ENDIF
	PRINTFORML %"基本料金", 25, LEFT%: %NUM_FORMAT(値段計算), 8%루피
ELSEIF 知識素質:性知識 < 0
;性知識マイナス勢
;お金の価値が分からないわけではないが、カラダの価値の相場を知らないので直感的にいま欲しい金額を言ってくる。
;幼稚ほどブッ飛んだ値段は提示してこないが結局値段はブレる。
	SELECTCASE RAND:4
	;４割で高額提示
	CASE 0
		値段計算 = 3000
	CASE 1
		値段計算 = 1500
	CASE 2
		値段計算 = 1000
	CASE 3
		値段計算 = 800
	CASE 4
		値段計算 = 500
	ENDSELECT
	PRINTFORML %"基本料金", 25, LEFT%: %NUM_FORMAT(値段計算), 8%루피
ELSEIF TALENT:非戦闘キャラ
;非戦闘キャラは、「戦うことで稼げる」キャラより相対的に肉体の価値が安く、「カラダを売って稼ぐ」ことへの抵抗感が戦闘キャラより薄いイメージ
	値段計算 = 800
	PRINTFORML %"基本料金", 25, LEFT%: %NUM_FORMAT(値段計算), 8%루피
ELSEIF TALENT:性転換 == 1
;元女だと嫌がって値段を高めに設定する(でも結局買われてしゃぶらされてしまう)
	値段計算 = 2000
	PRINTFORML %"基本料金", 25, LEFT%：　%NUM_FORMAT(値段計算), 8%루피
ELSE
;「基本的にみんな美女である」「普段売っていないので市場価値が高い」「戦闘能力のあるキャラは相応のプライドというものがある」などの理由から
;補正抜きで3000ルピ≒3万円とする。ここに素質で補正がかかり、地の文や口上でのプレイ内容に応じてオプションが上乗せされていく。
;さすがにフェラで30万円は高すぎるんよ……3万ですらかなり高いのに
	値段計算 = 1000
	PRINTFORML %"基本料金", 25, LEFT%：　%NUM_FORMAT(値段計算), 8%루피
ENDIF

;好感度
;好感度閾値の表現からして、親友あたりからお友達料金にしてくれるんじゃないかなと
LOCAL = (50 - CFLAG:好感度レベル) * -2
IF LOCAL < 0
	IF CFLAG:好感度レベル <= 20
	;友達未満だと大きく値上げ。初対面で4000円上乗せされるイメージ。普段身売りしてない美女に値段交渉するんだからそんくらい吹っ掛けてきてもおかしくないと思う。なお従業員採用に必要な好感度……
		PRINTFORML %"まだ親しくない", 25, LEFT%：＋%NUM_FORMAT(LOCAL * -4), 8%루피
		値段計算 -= LOCAL * 4
	ELSE
	;ただの友達だと若干の値上げ。値上げっていうかここまで含めて基本料金みたいなとこがある
		PRINTFORML %"ただの友達", 25, LEFT%：＋%NUM_FORMAT(LOCAL * -1), 8%루피
		値段計算 -= LOCAL
	ENDIF
ELSE
	;親友以上で値下げしてくれる。基本料金1万円で、好感度100で100ルピ≒1000円引きならまぁ妥当っちゃ妥当か
	SETCOLOR カラーパレット("ピンク")
	PRINTFORML %"お友達料金", 25, LEFT%：－%NUM_FORMAT(LOCAL), 8%루피
	RESETCOLOR
	値段計算 -= LOCAL
ENDIF

;容姿
IF TALENT:容姿 == -1
;あなたがブサイクの場合。あえてつけてる素質のはずだけど、ストレートに「醜い」だの「ブサイク」だの書くとプレイヤーの心にトゲが刺さりそうなため表現はマイルドに
;ブサイクに対する奉仕行為はプライドが傷つくだろうから値段高め
	値段計算 += 300
	PRINTFORML %"好みの顔じゃない", 25, LEFT%：＋%NUM_FORMAT(300), 8%루피
ENDIF
IF TALENT:容姿 == 1
;イケメン
	値段計算 -= 50
	PRINTFORML %"顔がいい", 25, LEFT%：－%NUM_FORMAT(50), 8%루피
ENDIF
IF TALENT:容姿 == 2
;絶世。
	値段計算 -= 100
	PRINTFORML %"めっちゃ顔がいい！", 25, LEFT%：－%NUM_FORMAT(100), 8%루피
ENDIF

;体力
;疲れてる時に顎とか疲れそうな奉仕を頼まれたら当然吹っ掛ける
IF BASE:TARGET:体力 < MAXBASE:TARGET:体力 / 4
	値段計算 += 1000
	SETCOLOR カラーパレット("薄ピンク")
	PRINTFORML %"体力低下", 25, LEFT%：＋%NUM_FORMAT(1000), 8%루피
	RESETCOLOR
ENDIF

;酩酊は値段ではなくむしろ実行判定にかかわったほうがいい気がするので移動。
;「安く売ってしまう」よりも、「ね、いいでしょ？」ってあなたのお願いに頷いてしまうほうがイメージに近い。

;恋人持ち
IF TALENT:恋人持ち == 2
	値段計算 += 500
	SETCOLOR カラーパレット("赤ピンク")
	PRINTFORML %"他人妻の唇", 25, LEFT%：＋%NUM_FORMAT(500), 8%루피
	RESETCOLOR
ENDIF
IF TALENT:恋人持ち == 1
	値段計算 += 300
	SETCOLOR カラーパレット("赤ピンク")
	PRINTFORML %"恋人のための唇", 25, LEFT%：＋%NUM_FORMAT(300), 8%루피
	RESETCOLOR
ENDIF
IF TALENT:恋人持ち == -1
;別に恋人になってるワケでもないのに「好きな人がいるから」ってだけで生意気にも値段を釣り上げてくるし、上昇幅は恋人持ちと同じ。
;「ゆ、許せねぇよ……絶対買って俺のものにしてやる……！」
;＊ あなたにケツイがみなぎった。
	値段計算 += 300
	SETCOLOR カラーパレット("ピンク")
	PRINTFORML %"好きな人がいる", 25, LEFT%：＋%NUM_FORMAT(300), 8%루피
	RESETCOLOR
ENDIF
;淫乱
IF TALENT:淫乱
	値段計算 -= 2500
	PRINTFORML %"淫乱", 16, LEFT%：－%NUM_FORMAT(2500), 8%루피
ENDIF

;同性愛
IF 同性愛性癖判定(TARGET,PLAYER) == 1
	;性癖素質:同性愛
	IF TALENT:TARGET:性愛傾向 == 1 ||TALENT:TARGET:性愛傾向 == 2
		素質名 = 異性愛
	ELSE
		素質名 = 同性愛
	ENDIF
	SELECTCASE 性癖素質:同性愛
		CASE 1
			;補正なし
		CASE 2
			値段計算 -= 100
			PRINTFORML %@"%소질명%(愛好)", 25, LEFT%：－%NUM_FORMAT(100), 8%루피
		CASE 3
			値段計算 -= 250
			PRINTFORML %@"%소질명%(中毒)", 25, LEFT%：－%NUM_FORMAT(250), 8%루피
		CASEELSE
			;好奇心
			IF TALENT:性的興味 > 0
				値段計算 -= 50
				PRINTFORML %@"好奇心(%소질명%)", 25, LEFT%：－%NUM_FORMAT(50), 8%루피
			ENDIF
			;保守的
			IF TALENT:性的興味 < 0
				値段計算 += 150
				SETCOLOR カラーパレット("薄ピンク")
				PRINTFORML %@"保守的(%소질명%)", 25, LEFT%：＋%NUM_FORMAT(150), 8%루피
				RESETCOLOR
			ENDIF
	ENDSELECT
ENDIF


;気丈
;「物怖じせず値段交渉に臨む」とするなら基本料金の一割増しくらいで吹っ掛けそう
IF TALENT:度胸 > 0
	値段計算 += 100
	SETCOLOR カラーパレット("薄ピンク")
	PRINTFORML %"気丈", 25, LEFT%：＋%NUM_FORMAT(100), 8%루피
	RESETCOLOR
ENDIF
;臆病
;気丈の逆で「高値を吹っ掛けて値段交渉するのが苦手」とするならば一割くらいまけてくれないかな……
IF TALENT:度胸 < 0
	値段計算 -= 100
	PRINTFORML %"臆病", 25, LEFT%：－%NUM_FORMAT(100), 8%루피
ENDIF

;プライド
;処女のとこでも参照しているが、こちらは基本料金にかかるので別枠。
;プライド高い
IF TALENT:プライド > 0
	値段計算 += 100
	SETCOLOR カラーパレット("薄ピンク")
	PRINTFORML %"プライド高い", 25, LEFT%：＋%NUM_FORMAT(100), 8%루피
	RESETCOLOR
ENDIF
;プライド低い
IF TALENT:プライド < 0
	値段計算 -= 100
	PRINTFORML %"プライド低い", 25, LEFT%：－%NUM_FORMAT(100), 8%루피
ENDIF

;謎の魅力
IF TALENT:PLAYER:謎の魅力
	値段計算 -= 100
	PRINTFORML %"謎の魅力", 25, LEFT%：－%NUM_FORMAT(100), 8%루피
ENDIF

;ABL:奉仕精神
;行為が奉仕そのものであるため金額に対する奉仕精神の影響がでかい
IF ABL:奉仕精神
	値段計算 -= ABL:奉仕精神 * 100
	PRINTFORML %"奉仕精神", 25, LEFT%：－%NUM_FORMAT(ABL:奉仕精神 * 100), 8%루피
ENDIF

;汚臭鈍感
;鈍感だろうと奉仕内容自体に変わりはないので大した値引きにはならない
IF TALENT:汚臭耐性 > 0
	値段計算 -= TALENT:汚臭耐性 * 50
	PRINTFORML %GET_TALENTNAME(61, TALENT:汚臭耐性,,TARGET), 25, LEFT%：－%NUM_FORMAT(TALENT:汚臭耐性 * 50), 8%루피
ENDIF
;汚臭敏感
IF TALENT:汚臭耐性 < 0
	値段計算 -= TALENT:汚臭耐性 * 100
	SETCOLOR カラーパレット("ピンク")
	PRINTFORML %GET_TALENTNAME(61, TALENT:汚臭耐性,,TARGET), 25, LEFT%：＋%NUM_FORMAT(ABS(TALENT:汚臭耐性) * 100), 8%루피
	RESETCOLOR
ENDIF

;献身的
IF TALENT:献身的
	値段計算 -= 100
	PRINTFORML %"献身的", 25, LEFT%：－%NUM_FORMAT(100), 8%루피
ENDIF

;貞操観念による売春への抵抗感。これは値段高めのほうが「らしさ」が出る
IF TALENT:貞操 == 1
	値段計算 += 500
	SETCOLOR カラーパレット("ピンク")
	PRINTFORML %"貞操観念", 25, LEFT%：＋%NUM_FORMAT(500), 8%루피
	RESETCOLOR
ENDIF

;女嫌い
IF TALENT:性別嗜好 == 2 && TALENT:PLAYER:性別 == 1
	値段計算 += 1000
	SETCOLOR カラーパレット("薄ピンク")
	PRINTFORML %"女嫌い", 25, LEFT%：＋%NUM_FORMAT(1000), 8%루피
	RESETCOLOR
ENDIF

;この時点で値段がマイナスになっていた場合、強制的に0まで戻す。買ってるはずなのに買われてんじゃねぇ！
SIF 値段計算 < 0
	値段計算 = 0

;割引クーポンはひとつまでです！
IF TALENT:対象キャラ:恋慕
	DRAWLINE
	PRINTFORML 할인
;恋慕は完全無料
	SETCOLOR カラーパレット("ピンク")
	PRINTFORM %"だいすき割", 25, LEFT%：　　　　　%CALLNAME:PLAYER%한정100％할인
	CALL PRINT_STRL(@"_H_")
	RESETCOLOR
	値段計算 *= 0
ELSEIF TALENT:対象キャラ:弱味
	DRAWLINE
PRINTFORML 할인
;弱みを握ってはした金で体を売らせたい！という鉄の意志
;せっかく値段が出るんだしタダで抱かせてもらうよりも「100円で買ってあげた」みたいののほうが尊厳を性的搾取できている感が出るので
;本来は30,000ルピ……ですが！なんと！今回に限り！お客様だけに！99%オフの300ルピで！！のほうが絶対にシコれる。古事記にもそう書かれている。
	SETCOLOR カラーパレット("赤ピンク")
PRINTFORM %"弱み", 25, LEFT%:　　　　　99% 오프
	CALL PRINT_STRL(@"_H_")
	RESETCOLOR
	値段計算 /= 100
;ELSEIF TALENT:金欠 || TALENT:貧乏
;お金に困っているときはちょっとお安くなるが、発情期のムラムラは値段に適用されなくなる。買っては欲しいがお金も欲しいため。
;	SETCOLOR カラーパレット("薄ピンク")
;	PRINTFORM %"金欠中", 25, LEFT%：　　　　　25％オフ
;	CALL PRINT_STRL(@"_H_")
;	RESETCOLOR
;	値段計算 /= 4 *= 3
ENDIF
DRAWLINE
IF TALENT:対象キャラ:恋慕
	値段計算 = -1
ELSE
	値段計算 = MAX(0, 値段計算)
ENDIF
IF 値段計算 > 0
PRINTFORML %"合計値段", 25, LEFT%:　%NUM_FORMAT(値段計算), 8%루피
ELSE
PRINTFORM %"合計値段", 25, LEFT%:　%"無料", 8%
	CALL PRINT_STRL(@"_H_")
ENDIF

RETURN 値段計算

;-------------------------------------------------
;実行判定
;-------------------------------------------------
@性処理_ABLE_手マン処理
#DIM ループ用
#DIM 許可好感度
#DIM 補正後好感度

;RETURN 0は非表示
SIF GETBIT(TALENT:PLAYER:性別, 0) == 0
	RETURN 0
SIF TALENT:PLAYER:Ｃ感度 == -2
	RETURN 0
IF GETBIT(TALENT:PLAYER:性別, 1)
	SIF TALENT:PLAYER:射精不可
		RETURN 0
ENDIF

;RETURN -1は表示するが選択出来ない
許可好感度 = 40
補正後好感度 = 補正後好感度算出(TARGET)
SIF BASE:酩酊 > MAXBASE:酩酊 / 2
	補正後好感度 += 20
;固有補正を有効に出来るよう、素質はここ
SIF TALENT:性処理不可 && !陥落チェック_性的(TARGET)
	補正後好感度 = 0
TRYCCALLFORM 性処理業務固有補正_可不可_{NO:TARGET}_手マン処理(TARGET, 補正後好感度)
	補正後好感度 = RESULT
CATCH
ENDCATCH
SIF 許可好感度 > 補正後好感度
	RETURN -1

RETURN 1

;-------------------------------------------------
;メッセージ
;-------------------------------------------------
@MESSAGE_性処理_手マン処理
#DIM 対象キャラ


対象キャラ = TARGET

PRINTFORM %CALLNAME:TARGET%은(는)
IF TALENT:TARGET:恋慕
PRINTFORM 요구받는 것이 기쁜지 미소로
ELSEIF TALENT:TARGET:弱味 || (TALENT:性別嗜好 == 2 && TALENT:PLAYER:性別 == 1)
;これだけ露骨に浮かぶバリエーションが多い……なんでやろな？
PRINTFORM %TEXTR("마지못해 하는 듯한 느낌으로/싫은 듯 얼굴을 찌푸리면서도 마지못해/불쾌한 듯 눈살을 찌푸리면서도 마지못해/싫은 듯 이쪽을 노려보면서도 마지못해")%
ELSEIF TALENT:TARGET:恋人持ち == 3
PRINTFORM 지금은 고인이 된 반려에게 작게 사죄를 말하면서도
ELSEIF TALENT:TARGET:恋人持ち == 2
PRINTFORM 반려에게 작게 사죄를 말하면서도
ELSEIF TALENT:TARGET:恋人持ち == 1
PRINTFORM 연인에게 작게 사죄를 말하면서도
ELSEIF TALENT:TARGET:恋人持ち == -1
PRINTFORM 마음에 둔 사람에게 작게 사죄를 말하면서도
ELSEIF TALENT:TARGET:セフレ
PRINTFORM 히죽히죽 놀리는 듯한 미소를 띠고
ELSEIF TALENT:TARGET:精神的余裕 == 2
PRINTFORM 천박하다고 한숨을 쉬면서도
ELSEIF TALENT:TARGET:ギャル
PRINTFORM 태연하게
ELSEIF TALENT:TARGET:羞恥心
PRINTFORM %TEXTR("얼굴을 새빨갛게 하고/부끄러워 고개를 숙이며")%면서
ELSEIF TALENT:TARGET:性的興味
PRINTFORM %TEXTR("흥미진진한/기대에 찬")%모습으로
ELSEIF TALENT:TARGET:性欲 <= -1
PRINTFORM 어디까지나 사무적으로
ELSE
PRINTFORM 부끄러워하면서도
ENDIF
PRINTFORMW %TEXTR("승낙/승낙")%하고, %CALLNAME:PLAYER%%TEXTR("와 가까운 물그림자로 숨었다/를 가까운 물그림자로 이끌었다/에게 이끌려 가까운 물그림자에 숨었다")%……
PRINTL
PRINTFORMW ────
PRINTL
;履歴

IF RFLAG:コマンド結果受渡し変数 == 1
	CALL 履歴データベース登録(CFLAG:PLAYER:人物番号, @"<font color='#%カラーパレット_HTML("赤ピンク")%'>仕事の体裁をとりながらも、結局無料で%CALLNAME:TARGET%に手マンしてもらった</font><img src='えっちハート'>","うふふ実績")
	CALL 履歴データベース登録(CFLAG:TARGET:人物番号, @"<font color='#%カラーパレット_HTML("赤ピンク")%'>大好きな%CALLNAME:PLAYER%に、無料で手マンで性処理してあげた</font><img src='えっちハート'>","うふふ実績")
ELSEIF TALENT:対象キャラ:弱味
	;弱味想定。いつか必要になるかもしれないし……
	CALL 履歴データベース登録(CFLAG:PLAYER:人物番号, @"<font color='#%カラーパレット_HTML("赤ピンク")%'>弱みを握った%CALLNAME:TARGET%に%MON_FORMAT(RFLAG:コマンド結果受渡し変数２)%で手マンしてもらった</font><img src='えっちハート'>","うふふ実績")
	CALL 履歴データベース登録(CFLAG:TARGET:人物番号, @"<font color='#%カラーパレット_HTML("赤ピンク")%'>%CALLNAME:PLAYER%に弱みを握られて、たった%MON_FORMAT(RFLAG:コマンド結果受渡し変数２)%で手マンさせられた</font><img src='えっちハート'>","うふふ実績")
ELSE
	CALL 履歴データベース登録(CFLAG:PLAYER:人物番号, @"<font color='#%カラーパレット_HTML("赤ピンク")%'>%MON_FORMAT(RFLAG:コマンド結果受渡し変数２)%で手マンしてもらった</font><img src='えっちハート'>","うふふ実績")
	CALL 履歴データベース登録(CFLAG:TARGET:人物番号, @"<font color='#%カラーパレット_HTML("赤ピンク")%'>%CALLNAME:PLAYER%に%MON_FORMAT(RFLAG:コマンド結果受渡し変数２)%で手マンしてあげた</font><img src='えっちハート'>","うふふ実績")
ENDIF

@MESSAGE_性処理_手マン処理_非口上時
#DIM 対象キャラ
#DIM 値段計算
#DIM オプション込み最終価格
#DIM 手コキ
#DIM 精液ごっくん
#DIM 胸揉み
#DIM キス
#DIM ファーストキス


対象キャラ = TARGET
手コキ = 0
精液ごっくん = 0
胸揉み = 0
キス = 0
ファーストキス = 0


IF TEQUIP:PLAYER:下半身服あり == 1
	IF TEQUIP:PLAYER:スカートめくり可 == 1
		PRINTFORM 눈앞에서 스커트를 걷어올렸다
	ELSE
		PRINTFORM 눈앞에서 옷을 벗겨 드러냈다
	ENDIF
ELSE
	PRINTFORM 눈앞에 드러냈다
ENDIF
PRINTFORML %CALLNAME:PLAYER%의 성기에, %CALLNAME:TARGET%는 살며시 손가락을 훑어%TEXTR("부드럽게 주무르듯이/손가락 끝으로 원을 그리듯이 주물러")%애무한다.
PRINTL

IF GETBIT(TALENT:PLAYER:性別, 1) == 1
;ふたなり
	CALL PRINT_STR(@"くちっ_H_くちゅっ_H_")
	PRINTFORML 하고 물소리를 울리는 핸드잡의%TEXTR("감촉/쾌감")%에 허리를 떨면서, %CALLNAME:PLAYER%가 함께 자지도 주물러 달라고 부탁하자,
	IF 陥落チェック(TARGET)
		PRINTFORMW %CALLNAME:TARGET%는 어쩔 수 없다는 듯 웃으며 핸드잡과는 반대 손으로 %CALLNAME:PLAYER%의 페니스에 살며시 손을 댔다.
		PRINTL
		PRINTFORML 끝에서 스며 나오는 선주와 %CALLNAME:PLAYER%의 애액으로 미끄러움을 좋게 하면서, %CALLNAME:TARGET%는 핸드잡을 하면서 능숙하게 %CALLNAME:PLAYER%의 후타나리 자지를 주무른다.
		PRINTL
		PRINTFORML 이윽고 헌신적인 %CALLNAME:TARGET%의 손기술의 쾌감에 %CALLNAME:PLAYER%가 허리를 튀기며 절정을 맞이하자,
		PRINTFORMW %CALLNAME:TARGET%는 정액%TEXTR("이 튀지 않도록/으로 옷을 더럽히지 않도록/이 머리에 묻지 않도록")%손바닥으로 사정을 받아주었다……。
		;一瞬咥えただけだから口淫経験とかは増えない方針で
		EXP:PLAYER:射精経験 += 1
		EXP:対象キャラ:手淫経験 += 1
		EXP:対象キャラ:精液経験 += 1
		SELECTCASE RAND:3
		CASE 0
			PRINTL
			PRINTFORM 이윽고 %CALLNAME:PLAYER%의 사정이 진정된 것을 확인하자, %CALLNAME:TARGET%는 손바닥에 고인 정액을
			CALL PRINT_STR(@"すん_H_")
			PRINTFORMW 하고 한 번 냄새를 맡고, %CALLNAME:PLAYER%를 올려다보며 히죽 웃어 보이고, 흥분을 부추기듯이 낼름낼름 핥아 먹었다……。
			PRINTL
			EXP:対象キャラ:精飲経験 += 1
			精液ごっくん = 1
		CASE 1
			PRINTL
PRINTFORM %CALLNAME:PLAYER%이(가) 손바닥에 고인 정액을 마셔달라고 부탁하자, %CALLNAME:TARGET%은(는) 쓴웃음을 지으면서도,
			CALL PRINT_STR(@"ずずっ_H_じゅるるっ_H_")
PRINTFORMW 하고 소리를 내며 들이마셔 사정 직후의%CALLNAME:PLAYER%의 흥분을 부추겼다……。
			PRINTL
			EXP:対象キャラ:精飲経験 += 1
			精液ごっくん = 1
		CASEELSE
			PRINTL
		ENDSELECT
		手コキ = 1
	ELSEIF TALENT:TARGET:弱味 || (TALENT:性別嗜好 == 2 && TALENT:PLAYER:性別 == 1) || TALENT:TARGET:恋人持ち >= 1 || TALENT:TARGET:恋人持ち == -1
	;嫌がりそうな子ら
PRINTFORMW %CALLNAME:TARGET%은(는) 망설이면서도 핸드잡과는 반대 손으로%CALLNAME:PLAYER%의 페니스에 살며시 손을 댔다.
		PRINTL
PRINTFORML %CALLNAME:TARGET%은(는)%TEXTR("눈살을 찌푸리며/얼굴을 찡그리며")%면서도, 끝에서 스며 나오는 선주와%CALLNAME:PLAYER%의 애액으로 미끄러움을 좋게 하고, 핸드잡을 하면서 능숙하게%CALLNAME:PLAYER%의 후타나리 꼬추를 주무른다.
		PRINTL
PRINTFORML 이윽고 헌신적인%CALLNAME:TARGET%의 손기술 쾌감에%CALLNAME:PLAYER%이(가) 허리를 튀기며 절정을 맞이하자,
PRINTFORMW %CALLNAME:TARGET%은(는) 정액%TEXTR("이 튀지 않도록/으로 옷을 더럽히지 않도록/이 머리카락에 묻지 않도록")% 손바닥으로 사정을 받아냈다……。
		EXP:PLAYER:射精経験 += 1
		EXP:対象キャラ:手淫経験 += 1
		EXP:対象キャラ:精液経験 += 1
		SELECTCASE RAND:3
		CASE 0
			PRINTL
PRINTFORM %CALLNAME:PLAYER%이(가) 손바닥에 고인 정액을 마셔달라고 부탁하자%CALLNAME:TARGET%은(는) 진심으로 싫은 듯 얼굴을 찡그렸지만,
			CALL PRINT_STR(@"ずずっ_H_じゅるるっ_H_")
PRINTFORMW 하고 소리를 내며 들이마셔 마셨다……。
			PRINTL
			EXP:対象キャラ:精飲経験 += 1
			精液ごっくん = 1
		CASE 1
			PRINTL
PRINTFORMW %CALLNAME:PLAYER%은(는) 손바닥에 고인 정액을 마셔달라고 부탁했지만, %CALLNAME:TARGET%은(는) 진심으로 싫은 듯 얼굴을 찡그리고 그것을 단호하게 거절했다……。
			PRINTL
		CASE 2
			PRINTL
		ENDSELECT
		手コキ = 1
	ELSE
PRINTFORMW %CALLNAME:TARGET%은(는) 승낙하고, 핸드잡과는 반대 손으로%CALLNAME:PLAYER%의 페니스에 살며시 손을 댔다.
		PRINTL
PRINTFORML 끝에서 스며 나오는 선주와%CALLNAME:PLAYER%의 애액으로 미끄러움을 좋게 하면서, %CALLNAME:TARGET%은(는) 핸드잡을 하면서 능숙하게%CALLNAME:PLAYER%의 후타나리 꼬추를 주무른다.
		PRINTL
PRINTFORML 이윽고 헌신적인%CALLNAME:TARGET%의 손기술 쾌감에%CALLNAME:PLAYER%이(가) 허리를 튀기며 절정을 맞이하자,
PRINTFORMW %CALLNAME:TARGET%은(는) 정액%TEXTR("이 튀지 않도록/으로 옷을 더럽히지 않도록/이 머리카락에 묻지 않도록")% 손바닥으로 사정을 받아주었다……。
		;一瞬咥えただけだから口淫経験とかは増えない方針で
		EXP:PLAYER:射精経験 += 1
		EXP:対象キャラ:手淫経験 += 1
		EXP:対象キャラ:精液経験 += 1
		SELECTCASE RAND:3
		CASE 0
			PRINTL
PRINTFORM %CALLNAME:PLAYER%이(가) 손바닥에 고인 정액을 마셔달라고 부탁하자%CALLNAME:TARGET%은(는) 얼굴을 찡그리고 망설였지만, 이윽고
			CALL PRINT_STR(@"ずずっ_H_じゅるるっ_H_")
PRINTFORMW 하고 소리를 내며 들이마셔%CALLNAME:PLAYER%의 정액을 마셔주었다……。
			PRINTL
			EXP:対象キャラ:精飲経験 += 1
			精液ごっくん = 1
		CASE 1
			PRINTL
			PRINTFORMW %CALLNAME:PLAYER%은(는) 손바닥에 고인 정액을 마셔주길 부탁했지만, %CALLNAME:TARGET%은(는) 싫다는 듯 얼굴을 찌푸리며 그것을 단호하게 거절했다……。
			PRINTL
		CASE 2
			PRINTL
		ENDSELECT
		手コキ = 1
	ENDIF
ELSE
	SELECTCASE RAND:2
	CASE 0
		CALL PRINT_STR(@"くちっ_H_くちゅっ_H_")
		PRINTFORM 하고 물소리를 울리는 핸드잡의%TEXTR("감촉/쾌감")%에 허리를 떨면서, %CALLNAME:PLAYER%이(가) 키스도 해달라고
		IF 陥落チェック(TARGET)
			PRINTFORML 조르면,
			PRINTFORM %CALLNAME:TARGET%은(는) %TEXTR("상냥하게/애태우듯이 음탕하게")% 미소 지으며,
			CALL PRINT_STR(@"ちゅっ_H_ちゅぱっ_H_")
			PRINTFORMW 하고 일부러 소리를 내며 %CALLNAME:PLAYER%에게 키스해 주었다……。
			PRINTL
			キス = 1
		ELSEIF TALENT:TARGET:弱味 || (TALENT:性別嗜好 == 2 && TALENT:PLAYER:性別 == 1) || TALENT:TARGET:恋人持ち >= 1 || TALENT:TARGET:恋人持ち == -1
			PRINTFORML 주문하자,
			PRINTFORMW %CALLNAME:TARGET%은(는) 질색하면서도 주문에 응하고, 싫다는 듯 눈살을 찌푸리면서도 %CALLNAME:PLAYER%에게 입맞춤했다……。
			PRINTL
			キス = 1
		ELSE
			IF 初体験済みチェック("ファーストキス", TARGET) == 0
				PRINTFORML 주문했지만,
				PRINTFORMW %CALLNAME:TARGET%에게는 %TEXTR("그건 안 된다고/싫다고 고개를 가로저으며")% 거절당하고 말았다……。
				PRINTL
			ELSE
				PRINTFORML 주문하자,
				PRINTFORM %CALLNAME:TARGET%은(는) 주문에 응하고,
				CALL PRINT_STR(@"ちゅ_H_")
				PRINTFORMW 하고 작게 립 소리를 내며 %CALLNAME:PLAYER%에게 입맞춤했다……。
				PRINTL
				キス = 1
			ENDIF
		ENDIF
		CALL 初体験日登録処理(PLAYER, TARGET, "ファーストキス", DAY * 1440 + TIME, GETPLACENAME(CFLAG:PLAYER:現在マップ種別, CFLAG:PLAYER:現在位置), "唇", "", 1)
		CALL 初体験日登録処理(TARGET, PLAYER, "ファーストキス", DAY * 1440 + TIME, GETPLACENAME(CFLAG:PLAYER:現在マップ種別, CFLAG:PLAYER:現在位置), "唇", "", 1)
		IF RESULT
			RCVAR:TARGET:ファーストキス中フラグ = 1
			CALL 履歴データベース登録(CFLAG:TARGET:人物番号, @"<font color='#%カラーパレット_HTML("薄ピンク")%'>%CALLNAME:PLAYER%に買われて手マンするさなか、%CALLNAME:PLAYER%にお願いされて[唇]にファーストキスを捧げた</font><img src='えっちハート'>","うふふ")
			CALL 履歴データベース登録(CFLAG:PLAYER:人物番号, @"<font color='#%カラーパレット_HTML("薄ピンク")%'>%CALLNAME:TARGET%のお金を払って手マンしてもらったついでに、初めてのキスまで捧げてもらった</font><img src='えっちハート'>","うふふ")
			ファーストキス = 1
		ENDIF
		CALL 初体験日登録処理(PLAYER, TARGET, "キス", DAY * 1440 + TIME, GETPLACENAME(CFLAG:PLAYER:現在マップ種別, CFLAG:PLAYER:現在位置), "唇", "", 0)
		CALL 初体験日登録処理(TARGET, PLAYER, "キス", DAY * 1440 + TIME, GETPLACENAME(CFLAG:PLAYER:現在マップ種別, CFLAG:PLAYER:現在位置), "唇", "", 0)
	CASE 1
		CALL PRINT_STR(@"くちっ_H_くちゅっ_H_")
		PRINTFORM 하고 물소리를 울리는 핸드잡의%TEXTR("감촉/쾌감")%에 허리를 떨면서, %CALLNAME:PLAYER%이(가) 가슴도 만져달라고
		IF 陥落チェック(TARGET)
			PRINTFORML 조르면,
			PRINTFORMW %CALLNAME:TARGET%은(는) %TEXTR("애태우듯이 음탕하게/능글능글하게")% 웃으며, %TEXTR("빙글빙글 유두를 밀어 넣듯이/손가락 끝으로 유두 주변을 애태우듯이/손바닥 전체로 움켜쥐듯이/욕망을 쏟아붓듯이 거칠게 주무르며/부드러움을 즐기듯이 주무르며")%%CALLNAME:PLAYER%의 가슴을 애무했다……。
			PRINTL
		ELSEIF TALENT:TARGET:弱味 || (TALENT:性別嗜好 == 2 && TALENT:PLAYER:性別 == 1) || TALENT:TARGET:恋人持ち >= 1 || TALENT:TARGET:恋人持ち == -1
			PRINTFORML 주문하면,
			PRINTFORMW %CALLNAME:TARGET%은(는) 질색하면서도 주문에 응해, %CALLNAME:PLAYER%의 가슴을 거칠게 주물렀다……。
			PRINTL
		ELSE
			PRINTFORML 주문하면,
			PRINTFORM %CALLNAME:TARGET%은(는) 주문에 응해, %TEXTR("빙글빙글 유두를 밀어 넣듯이/손가락 끝으로 유두 주변을 애태우듯이/손바닥 전체로 움켜쥐듯이/부드러움을 즐기듯이 주물러/욕망을 쏟아붓듯이 거칠게 주물러")%%CALLNAME:PLAYER%의 가슴을 애무했다……。
			PRINTL
		ENDIF
		胸揉み = 1
	ENDSELECT
ENDIF


DRAWLINE

;最終的な料金　1ルピ＝10円程度という想定で書いてる
IF RFLAG:コマンド結果受渡し変数２ > 0
	PRINTFORML %"基本料金", 25, LEFT%：　%NUM_FORMAT(RFLAG:コマンド結果受渡し変数２), 8%루피
ELSE
	PRINTFORM %"基本料金", 25, LEFT%：　%"無料", 8%
	CALL PRINT_STRL(@"_H_")
ENDIF

DRAWLINE


値段計算 = 0
PRINTFORML 추가 옵션

IF 手コキ == 1
	値段計算 += 1000
	SETCOLOR カラーパレット("赤ピンク")
	PRINTFORML %"手コキ", 25, LEFT%：＋%NUM_FORMAT(1000), 8%루피
	RESETCOLOR
ENDIF
IF 精液ごっくん == 1
	IF TALENT:汚臭耐性 < 0
	;汚臭敏感
		値段計算 -= TALENT:汚臭耐性 * 500
		SETCOLOR カラーパレット("赤ピンク")
		PRINTFORML %"精液ごっくん", 25, LEFT%：＋%NUM_FORMAT(ABS(TALENT:汚臭耐性) * 500), 8%루피
		RESETCOLOR
	ELSE
		値段計算 += 300
		SETCOLOR カラーパレット("赤ピンク")
		PRINTFORML %"精液ごっくん", 25, LEFT%：＋%NUM_FORMAT(300), 8%루피
		RESETCOLOR
	ENDIF
ENDIF
IF キス == 1
	IF ファーストキス == 1
		IF 知識素質:高貴 > 0
		;ロイヤルキッス100まんえん
			値段計算 += 100000
			SETCOLOR カラーパレット("赤ピンク")
			PRINTFORML %"高貴な唇の純潔", 25, LEFT%：＋%NUM_FORMAT(100000), 8%루피
			RESETCOLOR
		ELSEIF TALENT:恋人持ち == 2
		;人妻なのにファーストキス？妙だな……
			値段計算 += 10000
			SETCOLOR カラーパレット("赤ピンク")
			PRINTFORML %"他人妻の唇の純潔", 25, LEFT%：＋%NUM_FORMAT(10000), 8%루피
			RESETCOLOR
		ELSEIF TALENT:恋人持ち == 1
		;恋人あり
			値段計算 += 5000
			SETCOLOR カラーパレット("赤ピンク")
			PRINTFORML %"恋人に捧げたかった唇", 25, LEFT%：＋%NUM_FORMAT(5000), 8%루피
			RESETCOLOR
		ELSEIF TALENT:恋人持ち == -1
			値段計算 += 4000
			SETCOLOR カラーパレット("赤ピンク")
			PRINTFORML %"はじめてのキス", 25, LEFT%：＋%NUM_FORMAT(4000), 8%루피
			RESETCOLOR
		ELSE
			値段計算 += 3000
			SETCOLOR カラーパレット("赤ピンク")
			PRINTFORML %"はじめてのキス", 25, LEFT%：＋%NUM_FORMAT(3000), 8%루피
			RESETCOLOR
		ENDIF
	ELSEIF 陥落チェック(TARGET)
		値段計算 += 10
		SETCOLOR カラーパレット("ピンク")
		PRINTFORML %"らぶらぶべろちゅー", 25, LEFT%：＋%NUM_FORMAT(10), 8%루피
		RESETCOLOR
	ELSE
		値段計算 += 200
		PRINTFORML %"キス", 25, LEFT%：＋%NUM_FORMAT(200), 8%루피
	ENDIF
ENDIF
IF 胸揉み == 1
	値段計算 += 100
	SETCOLOR カラーパレット("赤ピンク")
	PRINTFORML %"胸揉み", 25, LEFT%：＋%NUM_FORMAT(100), 8%루피
	RESETCOLOR
ENDIF

;オプションは基本的に割引クーポン対象外となっております～
;恋慕は完全無料
IF TALENT:対象キャラ:恋慕
	DRAWLINE
	PRINTFORML 할인
	SETCOLOR カラーパレット("ピンク")
	PRINTFORM %"だいすき割", 25, LEFT%：　　　　　%CALLNAME:PLAYER%한정 100% 오프
	RESETCOLOR
	CALL PRINT_STRL(@"_H_")
	値段計算 *= 0
ELSEIF TALENT:対象キャラ:弱味
	DRAWLINE
	PRINTFORML 할인
	SETCOLOR カラーパレット("赤")
	PRINTFORM %"弱み", 25, LEFT%：　　　　　99% 오프
	RESETCOLOR
	CALL PRINT_STRL(@"_H_")
	値段計算 /= 100
ENDIF
DRAWLINE
値段計算 = MAX(0, 値段計算)
;オプション分のMONEY処理
MONEY -= 値段計算

オプション込み最終価格 = 値段計算 + RFLAG:コマンド結果受渡し変数２
IF オプション込み最終価格 > 0
	PRINTFORML %"オプション込み最終価格", 25, LEFT%：　%NUM_FORMAT(オプション込み最終価格), 8%루피
ELSE
	PRINTFORM %"オプション込み最終価格", 25, LEFT%：　%"無料", 8%
	CALL PRINT_STRL(@"_H_")
ENDIF
DRAWLINE

PRINTFORML %NUM_FORMAT(MONEY + オプション込み最終価格)% - %NUM_FORMAT(オプション込み最終価格)% = %NUM_FORMAT(MONEY)%루피
