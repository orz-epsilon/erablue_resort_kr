;-------------------------------------------------
;嘘告白させる
;-------------------------------------------------
@COMNAME88
#FUNCTIONS
TSTR:コマンド名受渡 = 거짓 고백시키기


;===================================================
;コマンドタイプ
;===================================================
@COMTYPE_88
#FUNCTION
TFLAG:コマンドタイプ受渡 = COMTYPE("うふふ")

@COM_TOOLTIP_88
LOCALS = <br>■거짓 고백시키다<br>
LOCALS += "상대에게 「당신을 향한 사랑의 말」을 강요한다. <br>상대에게 「대출 경험」이 있는 경우에만 가능."
LOCALS += "<br>마음에도 없는 말이라도 몇 번이고 반복해서 말하게 함으로써, 상대는 그 말에 익숙해지고 기피감은 옅어진다."
LOCALS += "<br>이윽고 익숙해질 무렵에는, 그 「마음에도 없는」 말이었을 것을 의식의 깊은 곳에 새겨 넣을 수 있을 것이다."
LOCALS += "<br>COM 타입: 우후후<br>획득 소스: 반감・굴종・애정・연심도・정복(PLAYER)"
LOCALS += "<br>고유 획득 경험: 없음<br>"
TSTR:ツールチップ受渡 = %LOCALS%

@COM88
;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
#DIM 性愛レベル保存
#DIM 恋心レベル保存

;セクハラ胸揉みの拒絶が反感200なので、最初はその倍の反感400くらいを基準とする
;話術5の口説くの愛情が600、恋心が200。「自分で言わせる」から「他人に言われる」よりも影響がデカいものとする。
SELECTCASE CFLAG:TARGET:嘘告白カウント
CASE 0 TO 5
;最初は反感バチバチで愛情なんて上がるもんかっ！って感じ。屈辱なので屈従いっぱい
;このほかにもなんらかをマイナスにしてもいい気がする。信頼度とか
	CALL SOURCE_CALC_征服(PLAYER, TARGET, 250)
	CALL SOURCE_CALC_反感(TARGET, PLAYER, 400)
	CALL SOURCE_CALC_屈従(TARGET, PLAYER, 400)
	CALL SOURCE_CALC_愛情(TARGET, PLAYER, 3)
	CALL SOURCE_CALC_好感度要素_恋心度UP(TARGET, PLAYER, 1)
CASE 6 TO 10
;徐々に言わされ慣れてきた。最初ほどの屈辱感はないので反感と一緒に屈従も減る
	CALL SOURCE_CALC_征服(PLAYER, TARGET, 250)
	CALL SOURCE_CALC_反感(TARGET, PLAYER, 300)
	CALL SOURCE_CALC_屈従(TARGET, PLAYER, 300)
	CALL SOURCE_CALC_愛情(TARGET, PLAYER, 60)
	CALL SOURCE_CALC_好感度要素_恋心度UP(TARGET, PLAYER, 20)
CASE 11 TO 24
;嫌だけどもう言わされ慣れた。刷り込みがこのあたりからぐっと進み始める。『言わされる』形式自体はそのままなので、以後屈従加算値はこれ以上下がらない
	CALL SOURCE_CALC_征服(PLAYER, TARGET, 250)
	CALL SOURCE_CALC_反感(TARGET, PLAYER, 150)
	CALL SOURCE_CALC_屈従(TARGET, PLAYER, 200)
	CALL SOURCE_CALC_愛情(TARGET, PLAYER, 400)
	CALL SOURCE_CALC_好感度要素_恋心度UP(TARGET, PLAYER, 140)
CASEELSE
;言わされることが完全に定着した。もはや反感も浮かばないが屈服しきっている自覚はある。
;本当に『心にもないこと』だって、自信をもって言えるかな？んん？
	CALL SOURCE_CALC_征服(PLAYER, TARGET, 250)
	CALL SOURCE_CALC_反感(TARGET, PLAYER, 10)
	CALL SOURCE_CALC_屈従(TARGET, PLAYER, 200)
	CALL SOURCE_CALC_愛情(TARGET, PLAYER, 800)
	CALL SOURCE_CALC_好感度要素_恋心度UP(TARGET, PLAYER, 280)
ENDSELECT

性愛レベル保存 = 100 / 2
FOR LOCAL, 0, 100
	IF 経験値テーブル:LOCAL >= CFLAG:TARGET:性愛度
		性愛レベル保存 = LOCAL / 2
		BREAK
	ENDIF
NEXT
恋心レベル保存 = 100
FOR LOCAL, 0, 100
	IF 経験値テーブル:LOCAL >= CFLAG:TARGET:恋心度
		恋心レベル保存 = LOCAL
		BREAK
	ENDIF
NEXT

;特殊イベント発生判定
;・性愛度の半分と恋心度の合計が80以上(性愛度100だと恋心30、性愛度80だと恋心40)で発生
;・1度発生するとそのうふふ中は再発生しない
IF 性愛レベル保存 + 恋心レベル保存 >= 80 && !TALENT:TARGET:恋慕 && !寝取らせ_嘘告白特殊イベント発生済
	RFLAG:コマンド結果受渡し変数 = 1
ELSE
	RFLAG:コマンド結果受渡し変数 = 0
ENDIF

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;EXPにするかCFLAGにするか……
;ステ画面に『嘘告白経験』って残らないほうが、ズブズブ感出るんじゃないか？ってことでCFLAGにしておく。

TCVAR:TARGET:嘘告白カウント_一日 += 1
SIF TCVAR:TARGET:嘘告白カウント_一日 <= 4
	CFLAG:TARGET:嘘告白カウント += 1

RETURN 1

@CAN_COM88(ARG)
;暫定
#DIM CONST 必要実行値 = 24
#DIM 実行値
#DIM ＋表示フラグ

SKIPDISP ARG
PRINTFORML 거짓 고백하게 만들기(%CALLNAME:TARGET%)
;-------------------------------------------------
;実行判定処理
;-------------------------------------------------
実行値 = 0
＋表示フラグ = 0

;すべての命令に共通の要素を考慮
CALL COM_ORDER
実行値 = RESULT
＋表示フラグ = RESULT:1

;嘘告白回数
IF CFLAG:嘘告白カウント
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += CFLAG:嘘告白カウント * 1
	PRINTFORM 거짓 고백{CFLAG:嘘告白カウント}회째({CFLAG:嘘告白カウント})
	＋表示フラグ = 1
ENDIF

;ABL:欲望
IF ABL:欲望
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += ABL:欲望 * 1
	PRINTFORM 욕망LV{ABL:欲望}({ABL:欲望 * 1})
	＋表示フラグ = 1
ENDIF
;ABL:奉仕精神
IF ABL:奉仕精神
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += ABL:奉仕精神 * 4
	PRINTFORM 봉사 정신LV{ABL:奉仕精神}({ABL:奉仕精神 * 4})
	＋表示フラグ = 1
ENDIF
;ABL:マゾ性感
IF ABL:マゾ性感
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += ABL:マゾ性感 * 2
	PRINTFORM 마조감각LV{ABL:マゾ性感}({ABL:マゾ性感 * 2})
	＋表示フラグ = 1
ENDIF
;ABL:精液中毒
IF ABL:精液中毒
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += ABL:精液中毒 * 3
	PRINTFORM 정액 중독LV{ABL:精液中毒}({ABL:精液中毒 * 3})
	＋表示フラグ = 1
ENDIF

IF MARK:快楽刻印
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += MARK:快楽刻印 * 1
	PRINTFORM 쾌락 각인LV{MARK:快楽刻印}({MARK:快楽刻印 * 1})
	＋表示フラグ = 1
ENDIF
;PALAM:欲情
IF GETPALAMLV(PALAM:欲情, 5)
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += GETPALAMLV(PALAM:欲情, 5) * 1
	PRINTFORM 욕정LV{GETPALAMLV(PALAM:欲情, 5)}({GETPALAMLV(PALAM:欲情, 5) * 1})
	＋表示フラグ = 1
ENDIF
;恥じらい
IF TALENT:羞恥心 > 0
	PRINT  - 
	実行値 -= 1
	PRINT 수줍음(1)
	＋表示フラグ = 1
ENDIF

;倒錯的
IF TALENT:倒錯的
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += 10
	PRINT 도착적(10)
	＋表示フラグ = 1
ENDIF

;態度
IF TALENT:態度 == -1
	SIF ＋表示フラグ
		PRINT  +
	実行値 += 6
	PRINT 순종적(6)
	＋表示フラグ = 1
ELSEIF TALENT:態度 == 1
	PRINT  - 
	実行値 -= 4
	PRINT 반항적(4)
	＋表示フラグ = 1
ENDIF

;プライド
IF TALENT:プライド == -1
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += 4
	PRINT 자존심 낮음(4)
	＋表示フラグ = 1
ELSEIF TALENT:プライド == 1
	PRINT  - 
	実行値 -= 6
	PRINT 자존심 높음(6)
	＋表示フラグ = 1
ENDIF

;快感の否定（淫乱、娼婦で無効）
IF TALENT:快感応答 < 0 && !TALENT:淫乱
	PRINT  - 
	実行値 -= 1
	PRINT 쾌감 부정(1)
	＋表示フラグ = 1
ENDIF
;男嫌い（恋慕、親愛で無効）
IF TALENT:性別嗜好 & 1 && !(TALENT:PLAYER:性別 & 1) && (!TALENT:恋慕 || PLAYER != MASTER)
	PRINT  - 
	実行値 -= 12
	PRINT 남성 혐오(12)
	＋表示フラグ = 1
ENDIF

;セフレ
IF TALENT:セフレ
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += 10
	PRINT 섹파(10)
	＋表示フラグ = 1
ENDIF

;発情期
IF CFLAG:発情期フラグ < 0
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += 6
	PRINT 발정 중(6)
	＋表示フラグ = 1
ENDIF

;寝取らせ夜這い時のフレーバー
IF TCVAR:言いなり && 寝取らせ_主導キャラ > 0
	PRINT  - 
	実行値 -= 100
	PRINTFORM %CALLNAME:寝取らせ_主導キャラ%가 보고 있음(100)
	＋表示フラグ = 1
ENDIF

;言いなり
IF TCVAR:言いなり
	SIF ＋表示フラグ
		PRINT  + 
	実行値 += 999
	PRINT 당신의 뜻대로(999)
	＋表示フラグ = 1
ENDIF

;合計を表示(必要実行値以上で実行)　暫定
PRINTFORM  = {実行値}

SIF 実行値 < 必要実行値
	PRINT  < 
SIF 実行値 == 必要実行値
	PRINT  = 
SIF 実行値 > 必要実行値
	PRINT  > 
PRINTFORM 실행값{必要実行値}

WAIT
SKIPDISP 0

;実行できない
SIF 実行値 < 必要実行値
	RETURN 0

RETURN 1
;-------------------------------------------------
;嘘告白実行判定
;-------------------------------------------------
@COM_ABLE88
SIF SAVESTR:ゲームフェイズ管理 != "通常モード"
	RETURN 0

;一括管理
SIF GLOBAL_COMABLE(0)
	RETURN RESULT
;相手に貸出経験がないなら無理
SIF EXP:貸出経験 == 0
	RETURN 0
;口を何かに使ってるなら無理
SIF TEQUIP:PLAYER:口
	RETURN 0
SIF TEQUIP:TARGET:口
	RETURN 0
;恋慕がついていると嘘じゃなくなるので無理
SIF TALENT:恋慕
	RETURN 0
;通常モード限定。「させるコマンド」だから指示っぽくはあるんだけど、タブ移動のひと手間がめんどくさい
;同時モードではできないようにしたほうが分岐が楽なので
SIF FLAG:モード管理 != 0
	RETURN 0
;貸出経験なくても人妻とかには使えてもいい気がしないでもない

RETURN 1

;-------------------------------------------------
;嘘告白時メッセージ
;-------------------------------------------------
@MESSAGE_COM88
#DIM 入力値

PRINTFORM %CALLNAME:PLAYER%는

IF TCVAR:言いなり == 1
	PRINTFORM %CALLNAME:寝取らせ_主導キャラ%%TEXTR("가 보는 앞에서/에게 보란듯이")%
ENDIF

IF MODE_存在判定_完全一致("Ｖ挿入系", PLAYER, TARGET)
	;あなたがチンポ突っ込んでる
		PRINTFORM %CALLNAME:TARGET%%TEXTR("의 암컷 구멍/의 보지/")%를%TEXTR("제 것인 양/")%범하면서,
ELSEIF MODE_存在判定_完全一致("Ｖ挿入系", TARGET, PLAYER)
	;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
		PRINTFORM %CALLNAME:TARGET%%TEXTR("를 범하고/에게 자신을 범하게 하며")%,
ELSEIF MODE_存在判定_完全一致("Ａ挿入系", PLAYER, TARGET)
	;あなたがチンポ突っ込んでる
		PRINTFORM %CALLNAME:TARGET%의%TEXTR("엉덩이 구멍/엉덩이 구멍/엉덩이 보지")%를%TEXTR("제 것인 양/")%범하면서,
ELSEIF MODE_存在判定_完全一致("Ａ挿入系", TARGET, PLAYER)
	;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
	PRINTFORM %CALLNAME:TARGET%%TEXTR("를 엉덩이 구멍으로 범하고/에게 자신의 엉덩이 구멍을 범하게 하며")%,
ELSE
	PRINTFORM ,
ENDIF
;他にもパイズリさせながら、とかもできるはずだけど今回は省略

PRINTFORM %CALLNAME:TARGET%에게

SELECTCASE CFLAG:TARGET:嘘告白カウント
CASE 0 TO 5
;最初のうちは言わせる内容はシンプルに。相手に「発言内容を選ぶ」及び「こちらの望まない発言をする」余地を与えない
	IF  (MODE_存在判定_完全一致("Ｖ挿入系", PLAYER, TARGET) && RAND:3 == 0) || (MODE_存在判定_完全一致("Ｖ挿入系", TARGET, PLAYER) && RAND:3 == 0) || (MODE_存在判定_完全一致("Ａ挿入系", PLAYER, TARGET) && RAND:3 == 0) || (MODE_存在判定_完全一致("Ａ挿入系", TARGET, PLAYER) && RAND:3 == 0)
		PRINTFORM 거짓말이라도 좋으니 %CALLNAME:PLAYER%를 향해 감사의 말을 하도록 강요했다.
		PRINTL
		PRINTFORM %CALLNAME:TARGET%는 %CALLNAME:PLAYER%에게 범해지면서 나오는 교성을%TEXTR("필사적으로/억지로")%%TEXTR("삼키면서/참으면서")%,
		PRINTFORML %TEXTR("진심으로 싫다는 듯이/혐오감에 떨리는 목소리로/굴욕감에 떨리는 목소리로")%、「%TEXTR("범해주셔서/섹스해주셔서/안아주셔서")%、%TEXTR("기쁩니다/감사합니다")%」라고 말했다……
	ELSE
		PRINTFORM 거짓말이라도 좋으니 %CALLNAME:PLAYER%를 향해 사랑의 말을
		PRINTFORML 하도록 강요했다.
	;	PRINTFORML 言いながら%TEXTR("キスを捧げる/唇を捧げる/キスする")%よう強要した。
	;	意図せずにファーストキス捧げるの嫌な人もいそうだけど、シチュとしては欲しい気もする。どうしたものか
		PRINTL
		PRINTFORM %CALLNAME:TARGET%는
		IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
		;あなたがチンポ突っ込んでる
			PRINTFORM %CALLNAME:PLAYER%에게 범해지면서 나오는 교성을%TEXTR("필사적으로/억지로")%%TEXTR("삼키면서/참으면서")%,
		ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
			;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
			PRINTFORM %CALLNAME:PLAYER%와 관계를 맺으며 새어 나오는 신음을%TEXTR("필사적으로/억지로")%%TEXTR("삼키면서/참으면서/억누르면서")%,
		ENDIF
		PRINTFORML %TEXTR("진심으로 싫다는 듯이/혐오감에 떨리는 목소리로")% "%CALLNAME:PLAYER%%TEXTR("를 좋아해/사랑해")%"라고 말했다……
	ENDIF
CASE 6 TO 10
;フェーズ自体は進行しているものの、いい感じの差分が思いつかない。
;むしろ差がつくのはリアクションだとは思うものの、一応分けておく
	IF  (MODE_存在判定_完全一致("Ｖ挿入系", PLAYER, TARGET) && RAND:3 == 0) || (MODE_存在判定_完全一致("Ｖ挿入系", TARGET, PLAYER) && RAND:3 == 0) || (MODE_存在判定_完全一致("Ａ挿入系", PLAYER, TARGET) && RAND:3 == 0) || (MODE_存在判定_完全一致("Ａ挿入系", TARGET, PLAYER) && RAND:3 == 0)
		PRINTFORML 거짓말이라도 좋으니 %CALLNAME:PLAYER%에게 감사의 말을 하도록 강요했다.
		PRINTL
		PRINTFORM %CALLNAME:TARGET%는 %CALLNAME:PLAYER%에게 범해지는 교성을 %TEXTR("필사적으로/힘겹게")%%TEXTR("씹어 삼키면서/참아가면서/억누르면서")%,
		PRINTFORML %TEXTR("싫다는 듯이/혐오감을 비치는 목소리로/분하다는 듯이/굴욕을 곱씹는 목소리로")% "%TEXTR("범해/섹스해/안아/사용해")%%TEXTR("줘서/주셔서")%, %TEXTR("기뻐요/감사합니다")%"라고 말했다……
	ELSE
		PRINTFORM 거짓말이라도 좋으니 %CALLNAME:PLAYER%에게 사랑의 말을
		PRINTFORML 말하도록 시켰다.
		PRINTL
		PRINTFORM %CALLNAME:TARGET%는
		IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
		;あなたがチンポ突っ込んでる
			PRINTFORM %CALLNAME:PLAYER%
			SIF TALENT:PLAYER:性別 & 2
				PRINTFORM 의 %TEXTR("페니스/자지")%
			PRINTFORM 에게 범해져 교성을 지르면서,
		ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
			;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
			PRINTFORM %CALLNAME:PLAYER%와 관계하며 헐떡이는 숨결을 흘리면서,
		ENDIF
		PRINTFORML %TEXTR("싫다는 듯이/마지못해 하는 듯이/몇 번이고 말하게 하는 것에 질렸다는 듯한 목소리로")% "%CALLNAME:PLAYER%%TEXTR("를 좋아해/사랑해")%"라고 말했다……
	ENDIF
CASE 11 TO 24
;このあたりから、「誰か」を選択式にして、対象にあなたを選ばせる。
;繰り返しで慣れてきたのを見計らって、こっそり「嘘でもいいから」を取っ払う
	IF  (MODE_存在判定_完全一致("Ｖ挿入系", PLAYER, TARGET) && RAND:4 == 0) || (MODE_存在判定_完全一致("Ｖ挿入系", TARGET, PLAYER) && RAND:4 == 0) || (MODE_存在判定_完全一致("Ａ挿入系", PLAYER, TARGET) && RAND:4 == 0) || (MODE_存在判定_完全一致("Ａ挿入系", TARGET, PLAYER) && RAND:4 == 0)
		PRINTFORML %CALLNAME:PLAYER%에게 감사의 말을 하도록 강요했다.
		PRINTL
		PRINTFORM %CALLNAME:TARGET%는 %CALLNAME:PLAYER%에게 범해져 교성을 지르면서,
		PRINTFORM %TEXTR("망설이면서도/망설이면서도 쾌락이 배어나는 목소리로/쾌락에 녹아내린 목소리로 분하다는 듯이")% "%TEXTR("범해/섹스해/안아/사용해")%%TEXTR("줘서/주셔서")%, %TEXTR("기뻐요/감사합니다")%"라고 %TEXTR("반복해서/몇 번이고")% 말했다……
		CALL PRINT_STR("、っ_H_」")
		PRINTFORML %CALLNAME:PLAYER%에게 사랑의 말을
	ELSEIF TCVAR:言いなり == 1
	;寝取りっクス中。主導キャラが見てる
		SELECTCASE RAND:3
		CASE 0
			PRINTFORM 말하도록 시켰다.
			PRINTFORML %CALLNAME:TARGET%는
			PRINTL
			PRINTFORM %CALLNAME:PLAYER%
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/자지")%
				PRINTFORM 에 범해져 교성을 지르면서,
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 교합하며 헐떡이는 숨결을 흘리면서,
			ENDIF
			PRINTFORML %TEXTR("망설이면서도/망설이면서도 쾌락이 스미는 목소리로/쾌락에 녹아내린 목소리로 분한 듯이")% "%CALLNAME:PLAYER%%TEXTR("이 좋아/이 너무 좋아/를 사랑해")%"라고 %TEXTR("반복해서/몇 번이고")% 말했다……
		CASE 1
			PRINTFORML %CALLNAME:寝取らせ_主導キャラ%와의 섹스와 어느 쪽이 더 기분 좋은지 %TEXTR("비교하라고/말하라고")% 일러두었다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/자지")%
				PRINTFORM 에 범해져 교성을 지르면서도
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 교합하며 헐떡이는 숨결을 흘리면서도
			ENDIF
			PRINTFORML %CALLNAME:PLAYER%의 의도를 이해하고, %TEXTR("망설이면서도/망설이면서도 쾌락이 스미는 목소리로/쾌락에 녹아내린 목소리로 분한 듯이")% "%CALLNAME:PLAYER%%TEXTR("와의 섹스/와")%가 더 %TEXTR("좋아/기분 좋아")%"라고 %TEXTR("반복해서/몇 번이고")% 말했다……
		CASE 2
			PRINTFORML %CALLNAME:寝取らせ_主導キャラ%와 누가 더 좋은지 %TEXTR("비교하라고/말하라고")% 일러두었다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/자지")%
				PRINTFORM 에 범해져 교성을 지르면서도
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 교합하며 헐떡이는 숨결을 흘리면서도
			ENDIF
			PRINTFORML %CALLNAME:PLAYER%의 의도를 이해하고, %TEXTR("망설이면서도/망설이면서도 쾌락이 스미는 목소리로/쾌락에 녹아내린 목소리로 분한 듯이")% "%CALLNAME:PLAYER%가 더 좋아"라고 %TEXTR("반복해서/몇 번이고")% 말했다……
		ENDSELECT
	ELSE
	;寝取りっクス中じゃない。主導キャラの見てないところでの、プライベートっクス。
		SELECTCASE RAND:3
		CASE 0
			PRINTFORM %CALLNAME:PLAYER%를 향해 사랑의 말을
			PRINTFORML 말하라고 일러두었다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/성기")%
				PRINTFORM 에게 범해지며 교성을 지르면서,
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 교감하며 신음 섞인 숨결을 흘리면서,
			ENDIF
			PRINTFORML %TEXTR("망설이면서도/망설이면서도 쾌락이 스며든 목소리로/쾌락에 녹아내린 목소리로 분한 듯이")%, 「%CALLNAME:PLAYER%%TEXTR("를 좋아해/를 정말 좋아해/를 사랑해")%」라고%TEXTR("반복해서/몇 번이고")% 말했다……
		CASE 1
			PRINTFORML 누구와의 섹스가 가장 기분 좋은지 대답하라고 일렀다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/성기")%
				PRINTFORM 에게 범해지며 교성을 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 교감하며 신음 섞인 숨결을 흘리면서
			ENDIF
			PRINTFORML , %TEXTR("망설이면서도/망설이면서도 쾌락이 스며든 목소리로/쾌락에 녹아내린 목소리로 분한 듯이")% 「%CALLNAME:PLAYER%」라고%TEXTR("반복해서/몇 번이고")% 말했다……
		CASE 2
			PRINTFORML 누구를 가장 좋아하는지 대답하라고 일렀다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/성기")%
				PRINTFORM 에게 범해지며 교성을 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 교감하며 신음 섞인 숨결을 흘리면서
			ENDIF
			PRINTFORML , %TEXTR("망설이면서도/망설이면서도 쾌락이 스며든 목소리로/쾌락에 녹아내린 목소리로 분한 듯이")% 「%CALLNAME:PLAYER%가 가장 좋아」라고%TEXTR("반복해서/몇 번이고")% 말했다……
		ENDSELECT
	ENDIF
CASEELSE
;言わされることが完全に定着した。もはや反感も浮かばず屈服しきっている自覚がある。
;これが本当に『嘘』告白なのかどうかは本人のみぞ知る……
	IF  (MODE_存在判定_完全一致("Ｖ挿入系", PLAYER, TARGET) && RAND:5 == 0) || (MODE_存在判定_完全一致("Ｖ挿入系", TARGET, PLAYER) && RAND:5 == 0) || (MODE_存在判定_完全一致("Ａ挿入系", PLAYER, TARGET) && RAND:5 == 0) || (MODE_存在判定_完全一致("Ａ挿入系", TARGET, PLAYER) && RAND:5 == 0)
		PRINTFORML %CALLNAME:PLAYER%에게 감사의 말을 하도록 강요했다.
		PRINTL
		PRINTFORM %CALLNAME:TARGET%는 %CALLNAME:PLAYER%에게 범해져 교성을 지르면서,
		PRINTFORM %TEXTR("망설이면서도/망설이면서도 쾌락이 배어나는 목소리로/쾌락에 녹아내린 목소리로 분하다는 듯이")%「%TEXTR("범해/섹스해/안아/써")%%TEXTR("줘서/주셔서")%、%TEXTR("기쁩니다/감사합니다")%
		CALL PRINT_STR("っ_H__H_」")
		PRINTFORML 라고 %TEXTR("반복해서/몇 번이고")% 말했다……
	ELSEIF TCVAR:言いなり == 1
	;寝取りっクス中。主導キャラが見てる
		SELECTCASE RAND:5
		CASE 0
			PRINTFORM %CALLNAME:PLAYER%에게 사랑의 말을
			PRINTFORML 하라고 명령했다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의 %TEXTR("페니스/좆")%
				PRINTFORM 에 범해져 교성을 지르면서,
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 관계하며 흐느끼는 숨결을 흘리면서,
			ENDIF
			PRINTFORM %TEXTR("완전히 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 굴러떨어진 암컷 같은 아양 떠는 목소리로/쾌락에 타락한 아양 떠는 목소리로/달콤한 목소리로 아양을 떨듯이/「이게 진심이야」라고 확신할 수 있을 정도로 애교 부리는 목소리로")%,
			IF RFLAG:コマンド結果受渡し変数
				;刷り込みが完了して、性愛快楽を恋慕感情と脳が勘違いしてしまった哀れな末路
				;・発生判定はソース追加処理参照
				;イベントが発生したことを記憶(一度発生するとそのうふふ中は再発生しない)
				寝取らせ_嘘告白特殊イベント発生済 = 1
				PRINTFORMW %CALLNAME:寝取らせ_主導キャラ%가 보고 있는 앞에서 「%TEXTR("정말 좋아하니까/사랑하니까")% %CALLNAME:PLAYER%의 것으로 만들어 주세요」라고 말해버렸다.
				PRINTL
				PRINTFORML ──어떻게 할까?
				PRINTL
				PRINTBUTTON "[0]연인으로서 받아들여 주겠다", 0
				PRINTL
				IF DT_SELECT("関係性データベース", @"(対象キャラ１ = {CFLAG:TARGET:人物番号} Or 対象キャラ１ = {CFLAG:寝取らせ_主導キャラ:人物番号}) And (対象キャラ２ = {CFLAG:TARGET:人物番号} Or 対象キャラ２ = {CFLAG:寝取らせ_主導キャラ:人物番号}) And (関係性種別 = '恋慕')")
					;対象と寝取らせ主導キャラが恋慕関係だった場合のみ関係を破棄させる選択肢を追加
					PRINTBUTTON @"[1]%CALLNAME:寝取らせ_主導キャラ%와의 관계를 끊는 것을 조건으로 받아들인다", 1
					PRINTL
				ENDIF
				PRINTBUTTON "[2]거절한다", 2
				PRINTL
				BINPUT
				入力値 = RESULT
				SELECTCASE 入力値
				CASE 0, 1
					PRINTFORML ──모처럼 인연을 맺어주었지만, 아무래도 %CALLNAME:寝取らせ_主導キャラ%는 %CALLNAME:TARGET%의 운명의 상대가 아니었던 것 같다.
					PRINTFORML 압도적인 우월감을 느끼면서, %CALLNAME:PLAYER%는 %CALLNAME:TARGET%를 %CALLNAME:寝取らせ_主導キャラ%에게서 빼앗아, 자신의 것으로 만들었다……
					PRINTL
					PRINTFORM %CALLNAME:PLAYER%가 주는 쾌락으로 고동친 심장을 ‘사랑’이라고 착각해 버린 가련한 %CALLNAME:TARGET%는, %CALLNAME:PLAYER%에게 [연모] 함락되어
					CALL PRINT_STRW("しまった……_H__H_")
					CALL COM88_嘘告白_恋慕陥落処理(TARGET, 寝取らせ_主導キャラ, 入力値)
				CASEELSE
					PRINTFORML 모처럼의 제안이지만, %CALLNAME:TARGET%에게는 아직 %CALLNAME:寝取らせ_主導キャラ%와의 관계를 유지하게 해야겠어.
					PRINTFORML %CALLNAME:PLAYER%는 그 제안을 일축하고, 다시 플레이로 돌아갔다……
				ENDSELECT
			ELSE
				PRINTFORML 「%CALLNAME:PLAYER%%TEXTR("를 좋아해/를 정말 좋아해/를 사랑해")%」라고 %TEXTR("반복해서/몇 번이고")% 말했다……
			ENDIF
		CASE 1
			PRINTFORML %CALLNAME:寝取らせ_主導キャラ%와의 섹스와 어느 쪽이 더 기분 좋은지 %TEXTR("비교하라고/말하라고")% 시켰다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/좆")%
				PRINTFORM 에 범해져 교성을 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 관계하며 신음 섞인 숨을 흘리면서
			ENDIF
			PRINTFORM %TEXTR("완전히 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 빠져든 암컷 같은 교태로운 목소리로/쾌락에 타락한 아양 섞인 목소리로/달콤한 목소리로 아양 떨듯이/「이것이 본심이다」라고 확신할 수 있는 어리광 부리는 목소리로")%
			PRINTFORML 「%CALLNAME:PLAYER%%TEXTR("와의 섹스/와")%가 %TEXTR("더 좋아/더 기분 좋아")%」라고 %TEXTR("반복해서/몇 번이고")% 말했다……
		CASE 2
			PRINTFORML %CALLNAME:寝取らせ_主導キャラ%와 어느 쪽이 더 좋은지 %TEXTR("비교하라고/말하라고")% 시켰다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/좆")%
				PRINTFORM 에 범해져 교성을 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 관계하며 신음 섞인 숨을 흘리면서
			ENDIF
			PRINTFORM %TEXTR("완전히 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 빠져든 암컷 같은 교태로운 목소리로/쾌락에 타락한 아양 섞인 목소리로/달콤한 목소리로 아양 떨듯이/「이것이 본심이다」라고 확신할 수 있는 어리광 부리는 목소리로")%
			PRINTFORML 「%CALLNAME:PLAYER%가 더 좋아」라고 %TEXTR("반복해서/몇 번이고")% 말했다……
		CASE 3
			PRINTFORML 자신이 누구의 것인지 대답하라고 시켰다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%은
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/자지")%
				PRINTFORM 에게 범해지며 교성을 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 교접하며 헐떡이는 숨결을 흘리면서
			ENDIF
			PRINTFORM %TEXTR("완전히 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 물든 암컷의 교태 섞인 목소리로/쾌락에 타락해버린 교태 섞인 목소리로/달콤한 목소리로 애교 부리듯이/「이게 본심이다」라고 확신할 수 있는 응석 가득한 목소리로")%
			PRINTFORML 「%CALLNAME:PLAYER%의 것」이라고%TEXTR("반복해서/몇 번이고")% 말했다……
		CASE 4
			PRINTFORML 누구%TEXTR("의 아이를 낳고 싶은지/에게 아이를 임신당하고 싶은지")% 답하라고 일렀다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%은
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/자지")%
				PRINTFORM 에게 범해지며 교성을 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 교접하며 헐떡이는 숨결을 흘리면서
			ENDIF
			PRINTFORM %TEXTR("완전히 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 물든 암컷의 교태 섞인 목소리로/쾌락에 타락해버린 교태 섞인 목소리로/달콤한 목소리로 애교 부리듯이/「이게 본심이다」라고 확신할 수 있는 응석 가득한 목소리로")%
			PRINTFORML 「%CALLNAME:PLAYER%의%TEXTR("아이/아기")%%TEXTR("가 좋아/를 원해")%」라고%TEXTR("반복해서/몇 번이고")% 말했다……
		ENDSELECT
	ELSE
	;寝取りっクス中じゃない。主導キャラの見てないところでの、プライベートっクス。
		SELECTCASE RAND:5
		CASE 0
			PRINTFORM %CALLNAME:PLAYER%를 향해 사랑의 말을
			PRINTFORML 말하라고 일렀다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%은
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/자지")%
				PRINTFORM 에게 범해지며 신음소리를 지르면서,
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 관계하며 헐떡이는 숨소리를 흘리면서,
			ENDIF
			PRINTFORM %TEXTR("푹 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 빠져든 암컷 같은 교태로운 목소리로/쾌락에 타락한 아양 떠는 목소리로/달콤한 목소리로 아양을 떨듯이/「이것이 본심이다」라고 확신할 수 있는 어리광 가득한 목소리로")%,
			PRINTFORML 「%CALLNAME:PLAYER%%TEXTR("을/를 좋아해/을/를 정말 좋아해/을/를 사랑해")%」라고 %TEXTR("계속/몇 번이고")% 말했다……
		CASE 1
			PRINTFORML 누구와의 섹스가 가장 기분 좋은지 대답하라고 일렀다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/좆")%
				PRINTFORM 에게 범해지며 신음소리를 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 관계하며 헐떡이는 숨소리를 흘리면서
			ENDIF
			PRINTFORM ,%TEXTR("푹 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 빠져든 암컷 같은 교태로운 목소리로/쾌락에 타락한 아양 떠는 목소리로/달콤한 목소리로 아양을 떨듯이/「이것이 본심이다」라고 확신할 수 있는 어리광 가득한 목소리로")%,
			PRINTFORML 「%CALLNAME:PLAYER%」라고 %TEXTR("계속/몇 번이고")% 말했다……
		CASE 2
			PRINTFORML 누구를 가장 좋아하는지 대답하라고 일렀다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/좆")%
				PRINTFORM 에게 범해지며 신음소리를 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 관계하며 헐떡이는 숨소리를 흘리면서
			ENDIF
			PRINTFORM ,%TEXTR("푹 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 빠져든 암컷 같은 교태로운 목소리로/쾌락에 타락한 아양 떠는 목소리로/달콤한 목소리로 아양을 떨듯이/「이것이 본심이다」라고 확신할 수 있는 어리광 가득한 목소리로")%,
			PRINTFORML 「%CALLNAME:PLAYER%가 가장 좋아」라고 %TEXTR("계속/몇 번이고")% 말했다……
		CASE 3
			PRINTFORML 자신이 누구의 것인지 대답하라고 일렀다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/자지")%
				PRINTFORM 에게 범해져 교성을 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 관계하며 헐떡이는 숨결을 흘리면서
			ENDIF
			PRINTFORM %TEXTR("완전히 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 빠져버린 암컷의 아양떠는 목소리로/쾌락에 타락해 버린 아양떠는 목소리로/달콤한 목소리로 아양떨듯이/「이것이 본심이다」라고 확신할 수 있는 응석 부리는 목소리로")%,
			PRINTFORML 「%CALLNAME:PLAYER%의 것」이라고%TEXTR("반복해서/몇 번이고")% 말했다……
		CASE 4
			PRINTFORML 누구%TEXTR("의 아이를 낳고 싶은지/에게 아이를 임신당하고 싶은지")% 대답하라고 일렀다.
			PRINTL
			PRINTFORM %CALLNAME:TARGET%는
			IF MODE_存在判定_完全一致("ＶＡ挿入系", PLAYER, TARGET)
			;あなたがチンポ突っ込んでる
				PRINTFORM %CALLNAME:PLAYER%
				SIF TALENT:PLAYER:性別 & 2
					PRINTFORM 의%TEXTR("페니스/자지")%
				PRINTFORM 에게 범해져 교성을 지르면서
			ELSEIF MODE_存在判定_完全一致("ＶＡ挿入系", TARGET, PLAYER)
				;あなたがチンポ咥えこんでる。ペニバンの可能性もあるので詳細な描写は省く
				PRINTFORM %CALLNAME:PLAYER%와 관계하며 헐떡이는 숨결을 흘리면서
			ENDIF
			PRINTFORM %TEXTR("완전히 녹아내린 목소리로/쾌락에 완전히 녹아내린 달콤한 목소리로/타락에 빠져버린 암컷의 아양떠는 목소리로/쾌락에 타락해 버린 아양떠는 목소리로/달콤한 목소리로 아양떨듯이/「이것이 본심이다」라고 확신할 수 있는 응석 부리는 목소리로")%,
			PRINTFORML 「%CALLNAME:PLAYER%의 %TEXTR("아이/아기")%가 %TEXTR("좋다고/갖고 싶다고")%」%TEXTR("반복해서/몇 번이고")% 말했다……
		ENDSELECT
	ENDIF
ENDSELECT

@COM88_嘘告白_恋慕陥落処理(対象キャラ, 寝取られ元キャラ, 関係破棄フラグ)
#DIM 対象キャラ
#DIM 寝取られ元キャラ
#DIM 関係破棄フラグ
#DIM 恋慕対象数
#DIM 恋慕レベル初期値
#DIM 恋慕レベル補正基準値
#DIM CONST 嘘告白回数下限 = 24

;恋慕対象に登録する処理
;ゲージ区分を恋慕に変更(恋慕レベルが上がるようにする)
CFLAG:対象キャラ:ゲージ起動分類 = 1

;恋慕レベルの設定
;・嘘告白すればするほど初期レベルが上がりやすくなる感じに
;基本値：告白が成功するようになるレベル(Lv50)
恋慕レベル初期値  = 50
;補正値1：下限値から10回ごとに+1
恋慕レベル補正基準値 = MAX(CFLAG:対象キャラ:嘘告白カウント - 嘘告白回数下限, 1)
恋慕レベル初期値 += 恋慕レベル補正基準値 / 10
;補正値2：0～[嘘告白回数 - 下限値]の乱数
恋慕レベル初期値 += RAND:恋慕レベル補正基準値
;上限100
CFLAG:対象キャラ:恋慕レベル = MIN(恋慕レベル初期値, 100)

IF !INRANGEARRAY(恋慕対象フラグ, 対象キャラ, 対象キャラ)
	;リストに登録
	;・このタイミングで「実はリスト上限なんだけどどうする？やめる？」って聞かれると興が醒めると思うので上限無視して登録しちゃう
	;恋慕対象数をカウントして登録位置を決定
	恋慕対象数 = INRANGEARRAY(恋慕対象フラグ, 1, キャラクタ数上限)
	恋慕対象フラグ:恋慕対象数 = 対象キャラ
ENDIF

;- 恋慕陥落したときの処理(COM352_告白するの処理をベースに調整)
;恋慕陥落素質を取得
TALENT:対象キャラ:恋慕 = 1
CLEARBIT TALENT:対象キャラ:陥落不可, 0
;恋慕陥落した日付を記憶
初体験日:対象キャラ:恋慕 = DAY

IF TALENT:対象キャラ:恋人持ち > 0
	IF !TALENT:対象キャラ:浮気
		;浮気素質の取得(寝取らせ時に取得済だと思うけど一応)
		TALENT:対象キャラ:浮気 = 1
		PRINTFORM %CALLNAME:対象キャラ%는
		SETCOLOR カラーパレット("えっちな色")
		PRINT [바람]
		RESETCOLOR
		PRINT 을 얻었다……
	ENDIF
ELSEIF TALENT:対象キャラ:恋人持ち == -1
	; 想い人ありの消失
	TALENT:TARGET:恋人持ち = 0
	PRINTFORM %CALLNAME:対象キャラ%는
	SETCOLOR カラーパレット("えっちな色")
	PRINT [사랑하는 사람이 있음]
	RESETCOLOR
	PRINT 을 잃었다……
ENDIF

;履歴登録
CALL 履歴データベース登録(CFLAG:PLAYER:人物番号, @"<img src='えっちハート'><font color='#%カラーパレット_HTML("赤ピンク")%'>%CALLNAME:対象キャラ%를 [연모] 함락시켜, %CALLNAME:寝取られ元キャラ%에게서 빼앗았다.</font><img src='えっちハート'>","うふふ実績")
CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"<img src='えっちハート'><font color='#%カラーパレット_HTML("赤ピンク")%'>%CALLNAME:PLAYER%에 의해 %CALLNAME:寝取られ元キャラ%에게서 떨어져, 함락소질 [연모]를 얻었다.</font><img src='えっちハート'>","うふふ実績")
CALL 履歴データベース登録(CFLAG:寝取られ元キャラ:人物番号, @"%CALLNAME:対象キャラ%를 %CALLNAME:PLAYER%에게 빼앗겼다.","うふふ実績")

;寝取られ元キャラとの関係破棄
SIF 関係破棄フラグ
	CALL COM88_嘘告白_関係破棄処理(対象キャラ, 寝取られ元キャラ)

@COM88_嘘告白_関係破棄処理(対象キャラ, 寝取られ元キャラ)
#DIM 対象キャラ
#DIM 寝取られ元キャラ
#DIM 人物番号1 
#DIM 人物番号2
#DIMS 関係性種別
#DIMS DT_NAME
#DIMS DT_FILT_EXP ; FILT_EXP > FILTER EXPRESSION
#DIM  DT_ID

DT_NAME = 関係性データベース
人物番号1 = CFLAG:対象キャラ:人物番号
人物番号2 = CFLAG:寝取られ元キャラ:人物番号
{
DT_FILT_EXP = (対象キャラ１ = {人物番号1} Or 対象キャラ１ = {人物番号2})
          And (対象キャラ２ = {人物番号1} Or 対象キャラ２ = {人物番号2})
          And (関係性種別 = '恋慕' Or 関係性種別 = 'セフレ')
}
IF DT_SELECT(DT_NAME, DT_FILT_EXP, , DT_ID)
	人物番号1 = DT_CELL_GET(DT_NAME, DT_ID, "対象キャラ１", 1)
	人物番号2 = DT_CELL_GET(DT_NAME, DT_ID, "対象キャラ２", 1)
	関係性種別 '= DT_CELL_GETS(DT_NAME, DT_ID, "関係性種別", 1)
	; DEBUGPRINTFORML {DT_ID}/{人物番号1}/{人物番号2}/%関係性種別%
	DT_ROW_REMOVE DT_NAME, DT_ID
ENDIF
CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"%CALLNAME:寝取られ元キャラ%와의 %関係性種別%관계를 해소했다.","うふふ実績")

